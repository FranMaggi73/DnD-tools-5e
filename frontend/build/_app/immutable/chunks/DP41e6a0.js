import{w as i}from"./TqFmUP0D.js";import{P as m}from"./D_G0BaV5.js";import{t as p}from"./CBmwglN4.js";function g(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}const E=i("🎲 Grimorio de Aventuras"),s="https://dm-events-backend-858373640437.us-central1.run.app/api";console.log("🔧 Entorno:","production");console.log("🌐 API URL:",s);async function n(e,t={}){const r=m(p),o={"Content-Type":"application/json",...t.headers};r&&(o.Authorization=`Bearer ${r}`);const a=await fetch(`${s}${e}`,{...t,headers:o});if(!a.ok){const c=await a.json().catch(()=>({error:"Error en la petición"}));throw new Error(c.error||"Error en la petición")}return a.json()}const f={createCampaign:e=>n("/campaigns",{method:"POST",body:JSON.stringify(e)}),getCampaigns:()=>n("/campaigns"),getCampaign:e=>n(`/campaigns/${e}`),deleteCampaign:e=>n(`/campaigns/${e}`,{method:"DELETE"}),getCampaignMembers:e=>n(`/campaigns/${e}/members`),invitePlayer:(e,t)=>n(`/campaigns/${e}/invite`,{method:"POST",body:JSON.stringify({userEmail:t})}),removePlayer:(e,t)=>n(`/campaigns/${e}/players/${t}`,{method:"DELETE"}),getMyInvitations:()=>n("/invitations"),respondToInvitation:(e,t)=>n(`/invitations/${e}/respond`,{method:"POST",body:JSON.stringify({action:t})}),createCharacter:(e,t)=>n(`/campaigns/${e}/characters`,{method:"POST",body:JSON.stringify(t)}),getCampaignCharacters:e=>n(`/campaigns/${e}/characters`),updateCharacter:(e,t)=>n(`/characters/${e}`,{method:"PUT",body:JSON.stringify(t)}),deleteCharacter:e=>n(`/characters/${e}`,{method:"DELETE"}),createEncounter:(e,t)=>n(`/campaigns/${e}/encounters`,{method:"POST",body:JSON.stringify({name:t})}),getActiveEncounter:e=>n(`/campaigns/${e}/encounters/active`),endEncounter:e=>n(`/encounters/${e}`,{method:"DELETE"}),resetEncounter:e=>n(`/encounters/${e}/reset`,{method:"POST"}),addCombatant:(e,t)=>n(`/encounters/${e}/combatants`,{method:"POST",body:JSON.stringify(t)}),getCombatants:e=>n(`/encounters/${e}/combatants`),updateCombatant:(e,t)=>n(`/combatants/${e}`,{method:"PUT",body:JSON.stringify(t)}),removeCombatant:e=>n(`/combatants/${e}`,{method:"DELETE"}),nextTurn:e=>n(`/encounters/${e}/next-turn`,{method:"POST"})},$={searchMonsters:async e=>{const t=await fetch(`https://api.open5e.com/v1/monsters/?search=${encodeURIComponent(e)}&limit=20`);if(!t.ok)throw new Error("Error buscando criaturas");return t.json()},getMonster:async e=>{const t=await fetch(`https://api.open5e.com/v1/monsters/${e}/`);if(!t.ok)throw new Error("Error obteniendo criatura");return t.json()},monsterToCombatant:(e,t)=>({type:"creature",name:e.name,initiative:t,maxHp:e.hit_points,currentHp:e.hit_points,armorClass:e.armor_class,isNpc:!0,creatureSource:"open5e"}),searchConditions:async e=>{const t=await fetch(`https://api.open5e.com/v1/conditions/?search=${encodeURIComponent(e)}&limit=5`);if(!t.ok)throw new Error("Error buscando condiciones");return t.json()},getCondition:async e=>{const t=await fetch(`https://api.open5e.com/v1/conditions/${e}/`);if(!t.ok)throw new Error("Error obteniendo condición");return t.json()},cleanDescription:(e,t=150)=>{const r=document.createElement("div");r.innerHTML=e;let o=r.textContent||r.innerText||"";return o.length>t&&(o=o.substring(0,t)+"..."),o}};export{f as a,g as e,E as h,$ as o};
