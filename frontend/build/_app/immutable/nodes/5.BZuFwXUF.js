import{S as xt,i as Ct,s as yt,n as ye,d,a as ce,m as o,b as te,c as s,e as c,f as b,h as k,g as R,o as U,j as u,k as I,t as q,A as Bt,r as ie,x as mt,u as rt,q as bt,Z as Xl,B as Xe,_ as ol,v as Ie,$ as Zl,U as qt,D as Ft,E as Gt,F as jt,G as Ke,H as Ge,I as Kt,J as Wt,K as Mt,L as Lt,M as St,l as il,p as Yl,N as $l,O as Xt}from"../chunks/D_G0BaV5.js";import{e as Re,o as gt,h as en,a as Qe}from"../chunks/5Suz-1-0.js";import"../chunks/IHki7fMi.js";import{p as tn}from"../chunks/D0AE5CJh.js";import{u as ln}from"../chunks/BLMm51hs.js";import{g as nn,c as cl,q as ul,w as Jt,o as dl,a as sn}from"../chunks/eN7n43qG.js";import{c as an}from"../chunks/Bhgkhhu0.js";function fl(n,e,t){const l=n.slice();return l[10]=e[t],l}function hl(n){let e,t="‚öîÔ∏è SU TURNO";return{c(){e=u("div"),e.textContent=t,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1fc3yjt"&&(e.textContent=t),this.h()},h(){o(e,"class","absolute -top-3 -right-3 badge badge-ornate text-lg animate-bounce z-10")},m(l,r){te(l,e,r)},d(l){l&&d(e)}}}function vl(n){let e,t='<span class="text-6xl">üíÄ</span>';return{c(){e=u("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-it6l4x"&&(e.innerHTML=t),this.h()},h(){o(e,"class","absolute inset-0 bg-error/20 flex items-center justify-center -z-10 rounded-lg")},m(l,r){te(l,e,r)},d(l){l&&d(e)}}}function pl(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"></path></svg>',r,i,a,f,p="üóëÔ∏è Eliminar",v,h;return{c(){e=u("div"),t=u("label"),t.innerHTML=l,r=I(),i=u("ul"),a=u("li"),f=u("a"),f.textContent=p,this.h()},l(_){e=c(_,"DIV",{class:!0});var x=b(e);t=c(x,"LABEL",{tabindex:!0,class:!0,"data-svelte-h":!0}),U(t)!=="svelte-13tftyw"&&(t.innerHTML=l),r=k(x),i=c(x,"UL",{tabindex:!0,class:!0});var m=b(i);a=c(m,"LI",{});var C=b(a);f=c(C,"A",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-hji4ll"&&(f.textContent=p),C.forEach(d),m.forEach(d),x.forEach(d),this.h()},h(){o(t,"tabindex","0"),o(t,"class","btn btn-ghost btn-xs btn-circle"),o(f,"class","text-error"),o(i,"tabindex","0"),o(i,"class","dropdown-content z-[1] menu p-2 shadow bg-neutral rounded-box w-52 border-2 border-secondary"),o(e,"class","dropdown dropdown-end")},m(_,x){te(_,e,x),s(e,t),s(e,r),s(e,i),s(i,a),s(a,f),v||(h=ie(f,"click",n[7]),v=!0)},p:ye,d(_){_&&d(e),v=!1,h()}}}function bl(n){let e,t=Re(n[0].conditions),l=[];for(let r=0;r<t.length;r+=1)l[r]=ml(fl(n,t,r));return{c(){e=u("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=c(r,"DIV",{class:!0});var i=b(e);for(let a=0;a<l.length;a+=1)l[a].l(i);i.forEach(d),this.h()},h(){o(e,"class","flex flex-wrap gap-1 mt-2")},m(r,i){te(r,e,i);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(r,i){if(i&1){t=Re(r[0].conditions);let a;for(a=0;a<t.length;a+=1){const f=fl(r,t,a);l[a]?l[a].p(f,i):(l[a]=ml(f),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(r){r&&d(e),mt(l,r)}}}function ml(n){let e,t=n[10]+"",l;return{c(){e=u("div"),l=q(t),this.h()},l(r){e=c(r,"DIV",{class:!0});var i=b(e);l=R(i,t),i.forEach(d),this.h()},h(){o(e,"class","badge badge-sm badge-warning text-xs")},m(r,i){te(r,e,i),s(e,l)},p(r,i){i&1&&t!==(t=r[10]+"")&&ce(l,t)},d(r){r&&d(e)}}}function _l(n){let e,t,l="üíö HP",r,i,a="‚ö†Ô∏è Estado",f,p;return{c(){e=u("div"),t=u("button"),t.textContent=l,r=I(),i=u("button"),i.textContent=a,this.h()},l(v){e=c(v,"DIV",{class:!0});var h=b(e);t=c(h,"BUTTON",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-13t9wqw"&&(t.textContent=l),r=k(h),i=c(h,"BUTTON",{class:!0,"data-svelte-h":!0}),U(i)!=="svelte-1e8bnzo"&&(i.textContent=a),h.forEach(d),this.h()},h(){o(t,"class","btn btn-xs btn-success flex-1"),o(i,"class","btn btn-xs btn-warning flex-1"),o(e,"class","flex gap-2 mt-3")},m(v,h){te(v,e,h),s(e,t),s(e,r),s(e,i),f||(p=[ie(t,"click",n[5]),ie(i,"click",n[6])],f=!0)},p:ye,d(v){v&&d(e),f=!1,rt(p)}}}function rn(n){let e,t,l,r,i,a,f,p,v,h=n[0].isNpc?"üëπ":"üßô‚Äç‚ôÇÔ∏è",_,x,m,C,E,g=n[0].name+"",D,y,H,L,S,V=n[0].initiative+"",O,N,G,Y,j=n[0].armorClass+"",K,T,P,z,Z,ee,le="Puntos de Vida",W,Q,fe=n[0].currentHp+"",pe,ae,ue=n[0].maxHp+"",he,be,$,me,Ee,re,A,w,X,F=n[1]&&hl(),B=n[3]&&vl(),M=n[2]&&pl(n),se=n[0].conditions&&n[0].conditions.length>0&&bl(n),ve=n[2]&&_l(n);return{c(){e=u("div"),F&&F.c(),t=I(),B&&B.c(),l=I(),r=u("div"),i=u("div"),a=u("div"),f=u("div"),p=u("div"),v=u("span"),_=q(h),m=I(),C=u("div"),E=u("h3"),D=q(g),y=I(),H=u("div"),L=u("div"),S=q("üé≤ "),O=q(V),N=I(),G=u("div"),Y=q("üõ°Ô∏è AC "),K=q(j),T=I(),M&&M.c(),P=I(),z=u("div"),Z=u("div"),ee=u("span"),ee.textContent=le,W=I(),Q=u("span"),pe=q(fe),ae=q("/"),he=q(ue),be=I(),$=u("progress"),A=I(),se&&se.c(),w=I(),ve&&ve.c(),this.h()},l(J){e=c(J,"DIV",{class:!0});var ne=b(e);F&&F.l(ne),t=k(ne),B&&B.l(ne),l=k(ne),r=c(ne,"DIV",{class:!0});var ge=b(r);i=c(ge,"DIV",{class:!0});var Ce=b(i);a=c(Ce,"DIV",{class:!0});var Me=b(a);f=c(Me,"DIV",{class:!0});var We=b(f);p=c(We,"DIV",{class:!0});var ke=b(p);v=c(ke,"SPAN",{class:!0});var Se=b(v);_=R(Se,h),Se.forEach(d),ke.forEach(d),We.forEach(d),Me.forEach(d),m=k(Ce),C=c(Ce,"DIV",{class:!0});var Le=b(C);E=c(Le,"H3",{class:!0});var Ze=b(E);D=R(Ze,g),Ze.forEach(d),y=k(Le),H=c(Le,"DIV",{class:!0});var we=b(H);L=c(we,"DIV",{class:!0});var Oe=b(L);S=R(Oe,"üé≤ "),O=R(Oe,V),Oe.forEach(d),N=k(we),G=c(we,"DIV",{class:!0});var Te=b(G);Y=R(Te,"üõ°Ô∏è AC "),K=R(Te,j),Te.forEach(d),we.forEach(d),Le.forEach(d),T=k(Ce),M&&M.l(Ce),Ce.forEach(d),P=k(ge),z=c(ge,"DIV",{class:!0});var qe=b(z);Z=c(qe,"DIV",{class:!0});var Pe=b(Z);ee=c(Pe,"SPAN",{class:!0,"data-svelte-h":!0}),U(ee)!=="svelte-1a9ef08"&&(ee.textContent=le),W=k(Pe),Q=c(Pe,"SPAN",{class:!0});var De=b(Q);pe=R(De,fe),ae=R(De,"/"),he=R(De,ue),De.forEach(d),Pe.forEach(d),be=k(qe),$=c(qe,"PROGRESS",{class:!0,max:!0}),b($).forEach(d),qe.forEach(d),A=k(ge),se&&se.l(ge),w=k(ge),ve&&ve.l(ge),ge.forEach(d),ne.forEach(d),this.h()},h(){o(v,"class","text-2xl"),o(p,"class","bg-primary/20 flex items-center justify-center"),o(f,"class",x="w-16 h-16 rounded-full ring-2 "+(n[1]?"ring-secondary":"ring-primary/50")),o(a,"class","avatar"),o(E,"class","font-medieval text-lg text-neutral font-bold"),o(L,"class","badge badge-sm bg-primary/30 text-neutral border-primary/50"),o(G,"class","badge badge-sm bg-info/30 text-neutral border-info/50"),o(H,"class","flex gap-2 mt-1"),o(C,"class","flex-1"),o(i,"class","flex items-start gap-3"),o(ee,"class","text-xs font-medieval text-neutral/70"),o(Q,"class","font-bold text-neutral"),o(Z,"class","flex justify-between items-center mb-1"),o($,"class",me="progress progress-"+n[4]+" w-full"),$.value=Ee=n[0].currentHp,o($,"max",re=n[0].maxHp),o(z,"class","mt-3"),o(r,"class","card-body p-4"),o(e,"class",X="card-parchment corner-ornament relative "+(n[1]?"ring-4 ring-secondary animate-pulse":"")+" "+(n[3]?"opacity-50":""))},m(J,ne){te(J,e,ne),F&&F.m(e,null),s(e,t),B&&B.m(e,null),s(e,l),s(e,r),s(r,i),s(i,a),s(a,f),s(f,p),s(p,v),s(v,_),s(i,m),s(i,C),s(C,E),s(E,D),s(C,y),s(C,H),s(H,L),s(L,S),s(L,O),s(H,N),s(H,G),s(G,Y),s(G,K),s(i,T),M&&M.m(i,null),s(r,P),s(r,z),s(z,Z),s(Z,ee),s(Z,W),s(Z,Q),s(Q,pe),s(Q,ae),s(Q,he),s(z,be),s(z,$),s(r,A),se&&se.m(r,null),s(r,w),ve&&ve.m(r,null)},p(J,[ne]){J[1]?F||(F=hl(),F.c(),F.m(e,t)):F&&(F.d(1),F=null),J[3]?B||(B=vl(),B.c(),B.m(e,l)):B&&(B.d(1),B=null),ne&1&&h!==(h=J[0].isNpc?"üëπ":"üßô‚Äç‚ôÇÔ∏è")&&ce(_,h),ne&2&&x!==(x="w-16 h-16 rounded-full ring-2 "+(J[1]?"ring-secondary":"ring-primary/50"))&&o(f,"class",x),ne&1&&g!==(g=J[0].name+"")&&ce(D,g),ne&1&&V!==(V=J[0].initiative+"")&&ce(O,V),ne&1&&j!==(j=J[0].armorClass+"")&&ce(K,j),J[2]?M?M.p(J,ne):(M=pl(J),M.c(),M.m(i,null)):M&&(M.d(1),M=null),ne&1&&fe!==(fe=J[0].currentHp+"")&&ce(pe,fe),ne&1&&ue!==(ue=J[0].maxHp+"")&&ce(he,ue),ne&16&&me!==(me="progress progress-"+J[4]+" w-full")&&o($,"class",me),ne&1&&Ee!==(Ee=J[0].currentHp)&&($.value=Ee),ne&1&&re!==(re=J[0].maxHp)&&o($,"max",re),J[0].conditions&&J[0].conditions.length>0?se?se.p(J,ne):(se=bl(J),se.c(),se.m(r,w)):se&&(se.d(1),se=null),J[2]?ve?ve.p(J,ne):(ve=_l(J),ve.c(),ve.m(r,null)):ve&&(ve.d(1),ve=null),ne&10&&X!==(X="card-parchment corner-ornament relative "+(J[1]?"ring-4 ring-secondary animate-pulse":"")+" "+(J[3]?"opacity-50":""))&&o(e,"class",X)},i:ye,o:ye,d(J){J&&d(e),F&&F.d(),B&&B.d(),M&&M.d(),se&&se.d(),ve&&ve.d()}}}function on(n,e,t){let l,r,i,{combatant:a}=e,{isCurrentTurn:f=!1}=e,{isDM:p=!1}=e;const v=Bt();function h(){v("updateHP",a)}function _(){v("addCondition",a)}function x(){v("remove",a)}return n.$$set=m=>{"combatant"in m&&t(0,a=m.combatant),"isCurrentTurn"in m&&t(1,f=m.isCurrentTurn),"isDM"in m&&t(2,p=m.isDM)},n.$$.update=()=>{n.$$.dirty&1&&t(8,l=a.currentHp/a.maxHp*100),n.$$.dirty&256&&t(4,r=l>50?"success":l>25?"warning":"error"),n.$$.dirty&1&&t(3,i=a.currentHp<=0)},[a,f,p,i,r,h,_,x,l]}class cn extends xt{constructor(e){super(),Ct(this,e,on,rn,yt,{combatant:0,isCurrentTurn:1,isDM:2})}}var Nt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function un(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function dn(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var Gl=dn,fn=typeof Nt=="object"&&Nt&&Nt.Object===Object&&Nt,hn=fn,vn=hn,pn=typeof self=="object"&&self&&self.Object===Object&&self,bn=vn||pn||Function("return this")(),Wl=bn,mn=Wl,_n=function(){return mn.Date.now()},gn=_n,xn=/\s/;function Cn(n){for(var e=n.length;e--&&xn.test(n.charAt(e)););return e}var yn=Cn,En=yn,kn=/^\s+/;function In(n){return n&&n.slice(0,En(n)+1).replace(kn,"")}var Tn=In,Dn=Wl,wn=Dn.Symbol,Jl=wn,gl=Jl,Ql=Object.prototype,Vn=Ql.hasOwnProperty,Hn=Ql.toString,_t=gl?gl.toStringTag:void 0;function On(n){var e=Vn.call(n,_t),t=n[_t];try{n[_t]=void 0;var l=!0}catch{}var r=Hn.call(n);return l&&(e?n[_t]=t:delete n[_t]),r}var Pn=On,An=Object.prototype,Nn=An.toString;function jn(n){return Nn.call(n)}var Mn=jn,xl=Jl,Ln=Pn,Sn=Mn,Bn="[object Null]",Un="[object Undefined]",Cl=xl?xl.toStringTag:void 0;function zn(n){return n==null?n===void 0?Un:Bn:Cl&&Cl in Object(n)?Ln(n):Sn(n)}var Rn=zn;function qn(n){return n!=null&&typeof n=="object"}var Fn=qn,Gn=Rn,Wn=Fn,Jn="[object Symbol]";function Qn(n){return typeof n=="symbol"||Wn(n)&&Gn(n)==Jn}var Kn=Qn,Xn=Tn,yl=Gl,Zn=Kn,El=NaN,Yn=/^[-+]0x[0-9a-f]+$/i,$n=/^0b[01]+$/i,es=/^0o[0-7]+$/i,ts=parseInt;function ls(n){if(typeof n=="number")return n;if(Zn(n))return El;if(yl(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=yl(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=Xn(n);var t=$n.test(n);return t||es.test(n)?ts(n.slice(2),t?2:8):Yn.test(n)?El:+n}var ns=ls,ss=Gl,Qt=gn,kl=ns,as="Expected a function",rs=Math.max,os=Math.min;function is(n,e,t){var l,r,i,a,f,p,v=0,h=!1,_=!1,x=!0;if(typeof n!="function")throw new TypeError(as);e=kl(e)||0,ss(t)&&(h=!!t.leading,_="maxWait"in t,i=_?rs(kl(t.maxWait)||0,e):i,x="trailing"in t?!!t.trailing:x);function m(V){var O=l,N=r;return l=r=void 0,v=V,a=n.apply(N,O),a}function C(V){return v=V,f=setTimeout(D,e),h?m(V):a}function E(V){var O=V-p,N=V-v,G=e-O;return _?os(G,i-N):G}function g(V){var O=V-p,N=V-v;return p===void 0||O>=e||O<0||_&&N>=i}function D(){var V=Qt();if(g(V))return y(V);f=setTimeout(D,E(V))}function y(V){return f=void 0,x&&l?m(V):(l=r=void 0,a)}function H(){f!==void 0&&clearTimeout(f),v=0,l=p=r=f=void 0}function L(){return f===void 0?a:y(Qt())}function S(){var V=Qt(),O=g(V);if(l=arguments,r=this,p=V,O){if(f===void 0)return C(p);if(_)return clearTimeout(f),f=setTimeout(D,e),m(p)}return f===void 0&&(f=setTimeout(D,e)),a}return S.cancel=H,S.flush=L,S}var cs=is;const Kl=un(cs);function Il(n,e,t){const l=n.slice();return l[36]=e[t],l}function Tl(n,e,t){const l=n.slice();return l[33]=e[t],l}function Dl(n){let e,t,l,r="‚úï",i,a,f="‚öîÔ∏è Agregar Combatiente",p,v,h,_,x,m,C,E,g,D,y,H;function L(O,N){return O[3]==="player"?ds:us}let S=L(n),V=S(n);return{c(){e=u("div"),t=u("div"),l=u("button"),l.textContent=r,i=I(),a=u("h3"),a.textContent=f,p=I(),v=u("div"),h=u("button"),_=q("üßù Jugador"),m=I(),C=u("button"),E=q("üêâ Monstruo"),D=I(),V.c(),this.h()},l(O){e=c(O,"DIV",{class:!0});var N=b(e);t=c(N,"DIV",{class:!0});var G=b(t);l=c(G,"BUTTON",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-1e8f2lk"&&(l.textContent=r),i=k(G),a=c(G,"H3",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-1n7thfu"&&(a.textContent=f),p=k(G),v=c(G,"DIV",{class:!0});var Y=b(v);h=c(Y,"BUTTON",{class:!0});var j=b(h);_=R(j,"üßù Jugador"),j.forEach(d),m=k(Y),C=c(Y,"BUTTON",{class:!0});var K=b(C);E=R(K,"üêâ Monstruo"),K.forEach(d),Y.forEach(d),D=k(G),V.l(G),G.forEach(d),N.forEach(d),this.h()},h(){o(l,"class","btn btn-sm btn-circle btn-ghost absolute right-2 top-2"),o(a,"class","font-bold text-2xl font-medieval text-neutral mb-4 text-center"),o(h,"class",x="btn btn-sm font-medieval "+(n[3]==="player"?"btn-primary":"btn-outline")),o(C,"class",g="btn btn-sm font-medieval "+(n[3]==="monster"?"btn-primary":"btn-outline")),o(v,"class","flex justify-center gap-4 mb-6"),o(t,"class","modal-box card-parchment max-w-3xl h-full relative"),o(e,"class","modal modal-open z-50")},m(O,N){te(O,e,N),s(e,t),s(t,l),s(t,i),s(t,a),s(t,p),s(t,v),s(v,h),s(h,_),s(v,m),s(v,C),s(C,E),s(t,D),V.m(t,null),y||(H=[ie(l,"click",n[15]),ie(h,"click",n[16]),ie(C,"click",n[17])],y=!0)},p(O,N){N[0]&8&&x!==(x="btn btn-sm font-medieval "+(O[3]==="player"?"btn-primary":"btn-outline"))&&o(h,"class",x),N[0]&8&&g!==(g="btn btn-sm font-medieval "+(O[3]==="monster"?"btn-primary":"btn-outline"))&&o(C,"class",g),S===(S=L(O))&&V?V.p(O,N):(V.d(1),V=S(O),V&&(V.c(),V.m(t,null)))},d(O){O&&d(e),V.d(),y=!1,rt(H)}}}function us(n){let e,t,l,r='<span class="label-text font-medieval text-neutral">Buscar monstruo (Open5e)</span>',i,a,f,p,v,h,_,x='<span class="label-text font-medieval text-neutral">Nombre</span>',m,C,E,g,D,y,H='<span class="label-text font-medieval text-neutral">Iniciativa</span>',L,S,V,O,N,G='<span class="label-text font-medieval text-neutral">HP M√°ximo</span>',Y,j,K,T,P,z='<span class="label-text font-medieval text-neutral">AC</span>',Z,ee,le,W,Q,fe="Cancelar",pe,ae,ue,he="‚öîÔ∏è",be,$,me,Ee,re=n[6].length>0&&wl(n);return{c(){e=u("div"),t=u("div"),l=u("label"),l.innerHTML=r,i=I(),a=u("input"),f=I(),re&&re.c(),p=I(),v=u("div"),h=u("div"),_=u("label"),_.innerHTML=x,m=I(),C=u("input"),E=I(),g=u("div"),D=u("div"),y=u("label"),y.innerHTML=H,L=I(),S=u("input"),V=I(),O=u("div"),N=u("label"),N.innerHTML=G,Y=I(),j=u("input"),K=I(),T=u("div"),P=u("label"),P.innerHTML=z,Z=I(),ee=u("input"),le=I(),W=u("div"),Q=u("button"),Q.textContent=fe,pe=I(),ae=u("button"),ue=u("span"),ue.textContent=he,be=q(" Agregar al Combate"),this.h()},l(A){e=c(A,"DIV",{class:!0});var w=b(e);t=c(w,"DIV",{class:!0});var X=b(t);l=c(X,"LABEL",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-1s7wqfp"&&(l.innerHTML=r),i=k(X),a=c(X,"INPUT",{type:!0,placeholder:!0,class:!0}),X.forEach(d),f=k(w),re&&re.l(w),p=k(w),v=c(w,"DIV",{class:!0});var F=b(v);h=c(F,"DIV",{class:!0});var B=b(h);_=c(B,"LABEL",{class:!0,"data-svelte-h":!0}),U(_)!=="svelte-n9vtz6"&&(_.innerHTML=x),m=k(B),C=c(B,"INPUT",{type:!0,class:!0}),B.forEach(d),E=k(F),g=c(F,"DIV",{class:!0});var M=b(g);D=c(M,"DIV",{class:!0});var se=b(D);y=c(se,"LABEL",{class:!0,"data-svelte-h":!0}),U(y)!=="svelte-loi7q8"&&(y.innerHTML=H),L=k(se),S=c(se,"INPUT",{type:!0,class:!0}),se.forEach(d),V=k(M),O=c(M,"DIV",{class:!0});var ve=b(O);N=c(ve,"LABEL",{class:!0,"data-svelte-h":!0}),U(N)!=="svelte-r75dry"&&(N.innerHTML=G),Y=k(ve),j=c(ve,"INPUT",{type:!0,class:!0}),ve.forEach(d),K=k(M),T=c(M,"DIV",{class:!0});var J=b(T);P=c(J,"LABEL",{class:!0,"data-svelte-h":!0}),U(P)!=="svelte-436dg3"&&(P.innerHTML=z),Z=k(J),ee=c(J,"INPUT",{type:!0,class:!0}),J.forEach(d),M.forEach(d),le=k(F),W=c(F,"DIV",{class:!0});var ne=b(W);Q=c(ne,"BUTTON",{class:!0,"data-svelte-h":!0}),U(Q)!=="svelte-acy963"&&(Q.textContent=fe),pe=k(ne),ae=c(ne,"BUTTON",{class:!0});var ge=b(ae);ue=c(ge,"SPAN",{class:!0,"data-svelte-h":!0}),U(ue)!=="svelte-v5ojki"&&(ue.textContent=he),be=R(ge," Agregar al Combate"),ge.forEach(d),ne.forEach(d),F.forEach(d),w.forEach(d),this.h()},h(){o(l,"class","label"),o(a,"type","text"),o(a,"placeholder","Ej: goblin, dragon..."),o(a,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50"),o(t,"class","form-control mb-4"),o(_,"class","label"),o(C,"type","text"),o(C,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50"),o(h,"class","form-control"),o(y,"class","label"),o(S,"type","number"),o(S,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50"),o(D,"class","form-control"),o(N,"class","label"),o(j,"type","number"),o(j,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50"),o(O,"class","form-control"),o(P,"class","label"),o(ee,"type","number"),o(ee,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50"),o(T,"class","form-control"),o(g,"class","grid grid-cols-3 gap-4"),o(Q,"class","btn btn-outline border-2 border-neutral text-neutral hover:bg-neutral hover:text-secondary font-medieval"),o(ue,"class","text-xl"),o(ae,"class","btn btn-dnd"),ae.disabled=$=!n[7]||!n[8]||!n[9]||n[4]<1,o(W,"class","modal-action justify-center gap-4 mt-4"),o(v,"class","space-y-4"),o(e,"class","space-y-4")},m(A,w){te(A,e,w),s(e,t),s(t,l),s(t,i),s(t,a),Ie(a,n[5]),s(e,f),re&&re.m(e,null),s(e,p),s(e,v),s(v,h),s(h,_),s(h,m),s(h,C),Ie(C,n[7]),s(v,E),s(v,g),s(g,D),s(D,y),s(D,L),s(D,S),Ie(S,n[4]),s(g,V),s(g,O),s(O,N),s(O,Y),s(O,j),Ie(j,n[8]),s(g,K),s(g,T),s(T,P),s(T,Z),s(T,ee),Ie(ee,n[9]),s(v,le),s(v,W),s(W,Q),s(W,pe),s(W,ae),s(ae,ue),s(ae,be),me||(Ee=[ie(a,"input",n[20]),ie(a,"input",n[12]),ie(C,"input",n[22]),ie(S,"input",n[23]),ie(j,"input",n[24]),ie(ee,"input",n[25]),ie(Q,"click",n[15]),ie(ae,"click",n[14])],me=!0)},p(A,w){w[0]&32&&a.value!==A[5]&&Ie(a,A[5]),A[6].length>0?re?re.p(A,w):(re=wl(A),re.c(),re.m(e,p)):re&&(re.d(1),re=null),w[0]&128&&C.value!==A[7]&&Ie(C,A[7]),w[0]&16&&Xe(S.value)!==A[4]&&Ie(S,A[4]),w[0]&256&&Xe(j.value)!==A[8]&&Ie(j,A[8]),w[0]&512&&Xe(ee.value)!==A[9]&&Ie(ee,A[9]),w[0]&912&&$!==($=!A[7]||!A[8]||!A[9]||A[4]<1)&&(ae.disabled=$)},d(A){A&&d(e),re&&re.d(),me=!1,rt(Ee)}}}function ds(n){var me,Ee,re;let e,t,l,r='<span class="label-text font-medieval text-neutral">Seleccionar Jugador</span>',i,a,f,p="-- Elegir jugador --",v,h,_,x='<span class="label-text font-medieval text-neutral">Iniciativa</span>',m,C,E,g,D,y,H,L=(((me=n[10])==null?void 0:me.name)||"Elegir jugador")+"",S,V,O,N,G=(((Ee=n[10])==null?void 0:Ee.maxHp)||0)+"",Y,j,K=(((re=n[10])==null?void 0:re.armorClass)||0)+"",T,P,z,Z,ee="Cancelar",le,W,Q,fe="‚öîÔ∏è",pe,ae,ue,he,be=Re(n[1]),$=[];for(let A=0;A<be.length;A+=1)$[A]=Hl(Tl(n,be,A));return{c(){e=u("div"),t=u("div"),l=u("label"),l.innerHTML=r,i=I(),a=u("select"),f=u("option"),f.textContent=p;for(let A=0;A<$.length;A+=1)$[A].c();v=I(),h=u("div"),_=u("label"),_.innerHTML=x,m=I(),C=u("input"),E=I(),g=u("div"),D=u("div"),y=u("div"),H=u("p"),S=q(L),V=I(),O=u("p"),N=q("HP: "),Y=q(G),j=q(" | AC: "),T=q(K),P=I(),z=u("div"),Z=u("button"),Z.textContent=ee,le=I(),W=u("button"),Q=u("span"),Q.textContent=fe,pe=q(" Agregar al Combate"),this.h()},l(A){e=c(A,"DIV",{class:!0});var w=b(e);t=c(w,"DIV",{class:!0});var X=b(t);l=c(X,"LABEL",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-1lzlsw9"&&(l.innerHTML=r),i=k(X),a=c(X,"SELECT",{class:!0});var F=b(a);f=c(F,"OPTION",{"data-svelte-h":!0}),U(f)!=="svelte-ws9sqz"&&(f.textContent=p);for(let Me=0;Me<$.length;Me+=1)$[Me].l(F);F.forEach(d),X.forEach(d),v=k(w),h=c(w,"DIV",{class:!0});var B=b(h);_=c(B,"LABEL",{class:!0,"data-svelte-h":!0}),U(_)!=="svelte-7krrq8"&&(_.innerHTML=x),m=k(B),C=c(B,"INPUT",{type:!0,min:!0,max:!0,step:!0,class:!0}),B.forEach(d),E=k(w),g=c(w,"DIV",{class:!0});var M=b(g);D=c(M,"DIV",{class:!0});var se=b(D);y=c(se,"DIV",{});var ve=b(y);H=c(ve,"P",{class:!0});var J=b(H);S=R(J,L),J.forEach(d),V=k(ve),O=c(ve,"P",{class:!0});var ne=b(O);N=R(ne,"HP: "),Y=R(ne,G),j=R(ne," | AC: "),T=R(ne,K),ne.forEach(d),ve.forEach(d),se.forEach(d),M.forEach(d),P=k(w),z=c(w,"DIV",{class:!0});var ge=b(z);Z=c(ge,"BUTTON",{class:!0,"data-svelte-h":!0}),U(Z)!=="svelte-acy963"&&(Z.textContent=ee),le=k(ge),W=c(ge,"BUTTON",{class:!0});var Ce=b(W);Q=c(Ce,"SPAN",{class:!0,"data-svelte-h":!0}),U(Q)!=="svelte-v5ojki"&&(Q.textContent=fe),pe=R(Ce," Agregar al Combate"),Ce.forEach(d),ge.forEach(d),w.forEach(d),this.h()},h(){o(l,"class","label"),f.__value="",Ie(f,f.__value),f.disabled=!0,f.selected=!0,o(a,"class","select select-bordered bg-[#2d241c] text-base-content border-primary/50"),n[2]===void 0&&Zl(()=>n[18].call(a)),o(t,"class","form-control"),o(_,"class","label"),o(C,"type","number"),o(C,"min","1"),o(C,"max","100"),o(C,"step","1"),C.required=!0,o(C,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50"),o(h,"class","form-control"),o(H,"class","text-lg font-bold text-neutral"),o(O,"class","text-sm text-neutral/70"),o(D,"class","flex items-center gap-4"),o(g,"class","card bg-neutral/20 border border-primary/40 p-4 mt-2"),o(Z,"class","btn btn-outline border-2 border-neutral text-neutral hover:bg-neutral hover:text-secondary font-medieval"),o(Q,"class","text-xl"),o(W,"class","btn btn-dnd"),W.disabled=ae=!n[10]||n[4]<1,o(z,"class","modal-action justify-center gap-4 mt-4"),o(e,"class","space-y-4")},m(A,w){te(A,e,w),s(e,t),s(t,l),s(t,i),s(t,a),s(a,f);for(let X=0;X<$.length;X+=1)$[X]&&$[X].m(a,null);ol(a,n[2],!0),s(e,v),s(e,h),s(h,_),s(h,m),s(h,C),Ie(C,n[4]),s(e,E),s(e,g),s(g,D),s(D,y),s(y,H),s(H,S),s(y,V),s(y,O),s(O,N),s(O,Y),s(O,j),s(O,T),s(e,P),s(e,z),s(z,Z),s(z,le),s(z,W),s(W,Q),s(W,pe),ue||(he=[ie(a,"change",n[18]),ie(C,"input",n[19]),ie(Z,"click",n[15]),ie(W,"click",n[11])],ue=!0)},p(A,w){var X,F,B;if(w[0]&2){be=Re(A[1]);let M;for(M=0;M<be.length;M+=1){const se=Tl(A,be,M);$[M]?$[M].p(se,w):($[M]=Hl(se),$[M].c(),$[M].m(a,null))}for(;M<$.length;M+=1)$[M].d(1);$.length=be.length}w[0]&6&&ol(a,A[2]),w[0]&16&&Xe(C.value)!==A[4]&&Ie(C,A[4]),w[0]&1024&&L!==(L=(((X=A[10])==null?void 0:X.name)||"Elegir jugador")+"")&&ce(S,L),w[0]&1024&&G!==(G=(((F=A[10])==null?void 0:F.maxHp)||0)+"")&&ce(Y,G),w[0]&1024&&K!==(K=(((B=A[10])==null?void 0:B.armorClass)||0)+"")&&ce(T,K),w[0]&1040&&ae!==(ae=!A[10]||A[4]<1)&&(W.disabled=ae)},d(A){A&&d(e),mt($,A),ue=!1,rt(he)}}}function wl(n){let e,t=Re(n[6]),l=[];for(let r=0;r<t.length;r+=1)l[r]=Vl(Il(n,t,r));return{c(){e=u("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=c(r,"DIV",{class:!0});var i=b(e);for(let a=0;a<l.length;a+=1)l[a].l(i);i.forEach(d),this.h()},h(){o(e,"class","grid grid-cols-1 gap-2 mb-4 max-h-48 overflow-y-auto")},m(r,i){te(r,e,i);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(r,i){if(i[0]&8256){t=Re(r[6]);let a;for(a=0;a<t.length;a+=1){const f=Il(r,t,a);l[a]?l[a].p(f,i):(l[a]=Vl(f),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(r){r&&d(e),mt(l,r)}}}function Vl(n){let e,t,l=n[36].name+"",r,i,a,f,p=n[36].challenge_rating+"",v,h,_,x;function m(){return n[21](n[36])}return{c(){e=u("button"),t=u("span"),r=q(l),i=I(),a=u("span"),f=q("CR "),v=q(p),h=I(),this.h()},l(C){e=c(C,"BUTTON",{class:!0});var E=b(e);t=c(E,"SPAN",{});var g=b(t);r=R(g,l),g.forEach(d),i=k(E),a=c(E,"SPAN",{class:!0});var D=b(a);f=R(D,"CR "),v=R(D,p),D.forEach(d),h=k(E),E.forEach(d),this.h()},h(){o(a,"class","text-xs text-neutral/60"),o(e,"class","btn btn-ghost text-left border border-primary/30 hover:bg-primary/20 flex justify-between")},m(C,E){te(C,e,E),s(e,t),s(t,r),s(e,i),s(e,a),s(a,f),s(a,v),s(e,h),_||(x=ie(e,"click",m),_=!0)},p(C,E){n=C,E[0]&64&&l!==(l=n[36].name+"")&&ce(r,l),E[0]&64&&p!==(p=n[36].challenge_rating+"")&&ce(v,p)},d(C){C&&d(e),_=!1,x()}}}function Hl(n){let e,t=n[33].name+"",l,r;return{c(){e=u("option"),l=q(t),this.h()},l(i){e=c(i,"OPTION",{});var a=b(e);l=R(a,t),a.forEach(d),this.h()},h(){e.__value=r=n[33].id,Ie(e,e.__value)},m(i,a){te(i,e,a),s(e,l)},p(i,a){a[0]&2&&t!==(t=i[33].name+"")&&ce(l,t),a[0]&2&&r!==(r=i[33].id)&&(e.__value=r,Ie(e,e.__value))},d(i){i&&d(e)}}}function fs(n){let e,t=n[0]&&Dl(n);return{c(){t&&t.c(),e=bt()},l(l){t&&t.l(l),e=bt()},m(l,r){t&&t.m(l,r),te(l,e,r)},p(l,r){l[0]?t?t.p(l,r):(t=Dl(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ye,o:ye,d(l){l&&d(e),t&&t.d(l)}}}function hs(n,e,t){let l,{isOpen:r=!1}=e,{players:i=[]}=e;const a=Bt();let f="player",p=0,v="";function h(){l&&(a("add",{type:"character",characterId:l.id,name:l.name,maxHp:l.maxHp,armorClass:l.armorClass,initiative:p,isNpc:!1}),O())}let _="",x=[],m=null,C="",E=0,g=10,D="",y="",H="";const L=Kl(async()=>{if(!_.trim()){t(6,x=[]);return}try{const le=await gt.searchMonsters(_);t(6,x=le.results.slice(0,3))}catch(le){console.error(le),t(6,x=[])}finally{}},300);async function S(le){m=await gt.getMonster(le.slug),t(7,C=m.name),t(8,E=m.hit_points),t(9,g=m.armor_class),D=m.challenge_rating,m.type,y=m.size,H=m.alignment,t(6,x=[]),t(5,_="")}function V(){!C||!E||!g||(a("add",{type:"creature",name:C,initiative:p,maxHp:E,armorClass:g,cr:D,size:y,alignment:H,isNpc:!0}),O())}function O(){t(2,v=""),m=null,t(5,_=""),t(6,x=[]),t(7,C=""),t(4,p=0),t(8,E=0),t(9,g=10),D="",y="",H="",a("close")}const N=()=>t(3,f="player"),G=()=>t(3,f="monster");function Y(){v=Xl(this),t(2,v),t(1,i)}function j(){p=Xe(this.value),t(4,p)}function K(){_=this.value,t(5,_)}const T=le=>S(le);function P(){C=this.value,t(7,C)}function z(){p=Xe(this.value),t(4,p)}function Z(){E=Xe(this.value),t(8,E)}function ee(){g=Xe(this.value),t(9,g)}return n.$$set=le=>{"isOpen"in le&&t(0,r=le.isOpen),"players"in le&&t(1,i=le.players)},n.$$.update=()=>{n.$$.dirty[0]&6&&t(10,l=i.find(le=>le.id===v))},[r,i,v,f,p,_,x,C,E,g,l,h,L,S,V,O,N,G,Y,j,K,T,P,z,Z,ee]}class vs extends xt{constructor(e){super(),Ct(this,e,hs,fs,yt,{isOpen:0,players:1},null,[-1,-1])}}function Ol(n){let e,t,l,r="‚úï",i,a,f,p="üíö Gesti√≥n de Puntos de Vida",v,h,_,x,m,C,E=n[1].isNpc?"üëπ":"üßô‚Äç‚ôÇÔ∏è",g,D,y,H,L=n[1].name+"",S,V,O,N,G,Y,j,K,T="HP ACTUAL",P,z,Z,ee=n[1].currentHp+"",le,W,Q,fe,pe=n[1].maxHp+"",ae,ue,he,be,$,me,Ee,re,A=n[4].toFixed(0)+"",w,X,F,B,M,se="HP NUEVO",ve,J,ne,ge,Ce,Me,We,ke,Se,Le,Ze,we,Oe=n[2].toFixed(0)+"",Te,qe,Pe,De,oe,_e,Ye='<span class="label-text font-medieval text-neutral">üé≤ Cantidad de HP</span>',et,Ve,Ae,ut,Ne,Je,ot="üí•",dt,Be,tt="Da√±o",lt,nt,je,Ue,it="üíö",ft,ze,ct="Curar",$e,ht,Zt,He=n[1].isNpc&&Pl();function Yt(de,xe){return de[7]!==0?bs:ps}let Et=Yt(n),Fe=Et(n);return{c(){e=u("div"),t=u("div"),l=u("button"),l.textContent=r,i=I(),a=u("div"),f=u("h3"),f.textContent=p,v=I(),h=u("div"),_=u("div"),x=u("div"),m=u("div"),C=u("span"),g=q(E),D=I(),y=u("div"),H=u("h4"),S=q(L),V=I(),O=u("div"),He&&He.c(),N=I(),G=u("div"),Y=u("div"),j=u("div"),K=u("p"),K.textContent=T,P=I(),z=u("div"),Z=u("p"),le=q(ee),W=I(),Q=u("p"),fe=q("de "),ae=q(pe),ue=I(),he=u("progress"),Ee=I(),re=u("p"),w=q(A),X=q("%"),F=I(),B=u("div"),M=u("p"),M.textContent=se,ve=I(),J=u("div"),ne=u("p"),ge=q(n[3]),Me=I(),Fe.c(),We=I(),ke=u("progress"),Ze=I(),we=u("p"),Te=q(Oe),qe=q("%"),De=I(),oe=u("div"),_e=u("label"),_e.innerHTML=Ye,et=I(),Ve=u("div"),Ae=u("input"),ut=I(),Ne=u("button"),Je=u("span"),Je.textContent=ot,dt=I(),Be=u("span"),Be.textContent=tt,nt=I(),je=u("button"),Ue=u("span"),Ue.textContent=it,ft=I(),ze=u("span"),ze.textContent=ct,this.h()},l(de){e=c(de,"DIV",{class:!0});var xe=b(e);t=c(xe,"DIV",{class:!0});var vt=b(t);l=c(vt,"BUTTON",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-ghishr"&&(l.textContent=r),i=k(vt),a=c(vt,"DIV",{class:!0});var kt=b(a);f=c(kt,"H3",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-1i9waqd"&&(f.textContent=p),v=k(kt),h=c(kt,"DIV",{class:!0});var It=b(h);_=c(It,"DIV",{class:!0});var $t=b(_);x=c($t,"DIV",{class:!0});var el=b(x);m=c(el,"DIV",{class:!0});var tl=b(m);C=c(tl,"SPAN",{class:!0});var ll=b(C);g=R(ll,E),ll.forEach(d),tl.forEach(d),el.forEach(d),$t.forEach(d),D=k(It),y=c(It,"DIV",{class:!0});var Tt=b(y);H=c(Tt,"H4",{class:!0});var nl=b(H);S=R(nl,L),nl.forEach(d),V=k(Tt),O=c(Tt,"DIV",{class:!0});var sl=b(O);He&&He.l(sl),sl.forEach(d),Tt.forEach(d),It.forEach(d),kt.forEach(d),N=k(vt),G=c(vt,"DIV",{class:!0});var Dt=b(G);Y=c(Dt,"DIV",{class:!0});var wt=b(Y);j=c(wt,"DIV",{class:!0});var st=b(j);K=c(st,"P",{class:!0,"data-svelte-h":!0}),U(K)!=="svelte-15e8cb6"&&(K.textContent=T),P=k(st),z=c(st,"DIV",{class:!0});var Vt=b(z);Z=c(Vt,"P",{class:!0});var al=b(Z);le=R(al,ee),al.forEach(d),W=k(Vt),Q=c(Vt,"P",{class:!0});var Ut=b(Q);fe=R(Ut,"de "),ae=R(Ut,pe),Ut.forEach(d),Vt.forEach(d),ue=k(st),he=c(st,"PROGRESS",{class:!0,max:!0}),b(he).forEach(d),Ee=k(st),re=c(st,"P",{class:!0});var zt=b(re);w=R(zt,A),X=R(zt,"%"),zt.forEach(d),st.forEach(d),F=k(wt),B=c(wt,"DIV",{class:!0});var at=b(B);M=c(at,"P",{class:!0,"data-svelte-h":!0}),U(M)!=="svelte-ukgy9p"&&(M.textContent=se),ve=k(at),J=c(at,"DIV",{class:!0});var Ht=b(J);ne=c(Ht,"P",{class:!0});var rl=b(ne);ge=R(rl,n[3]),rl.forEach(d),Me=k(Ht),Fe.l(Ht),Ht.forEach(d),We=k(at),ke=c(at,"PROGRESS",{class:!0,max:!0}),b(ke).forEach(d),Ze=k(at),we=c(at,"P",{class:!0});var Rt=b(we);Te=R(Rt,Oe),qe=R(Rt,"%"),Rt.forEach(d),at.forEach(d),wt.forEach(d),De=k(Dt),oe=c(Dt,"DIV",{});var Ot=b(oe);_e=c(Ot,"LABEL",{class:!0,"data-svelte-h":!0}),U(_e)!=="svelte-7wz7aa"&&(_e.innerHTML=Ye),et=k(Ot),Ve=c(Ot,"DIV",{class:!0});var pt=b(Ve);Ae=c(pt,"INPUT",{type:!0,placeholder:!0,class:!0,min:!0}),ut=k(pt),Ne=c(pt,"BUTTON",{class:!0});var Pt=b(Ne);Je=c(Pt,"SPAN",{class:!0,"data-svelte-h":!0}),U(Je)!=="svelte-qwnz9x"&&(Je.textContent=ot),dt=k(Pt),Be=c(Pt,"SPAN",{class:!0,"data-svelte-h":!0}),U(Be)!=="svelte-1lnjjvd"&&(Be.textContent=tt),Pt.forEach(d),nt=k(pt),je=c(pt,"BUTTON",{class:!0});var At=b(je);Ue=c(At,"SPAN",{class:!0,"data-svelte-h":!0}),U(Ue)!=="svelte-cy0xo0"&&(Ue.textContent=it),ft=k(At),ze=c(At,"SPAN",{class:!0,"data-svelte-h":!0}),U(ze)!=="svelte-2fk1mx"&&(ze.textContent=ct),At.forEach(d),pt.forEach(d),Ot.forEach(d),Dt.forEach(d),vt.forEach(d),xe.forEach(d),this.h()},h(){o(l,"class","btn btn-sm btn-circle btn-ghost absolute right-3 top-3 z-10 hover:bg-error/20"),o(f,"class","font-bold text-2xl font-medieval text-neutral text-center mb-3"),o(C,"class","text-xl"),o(m,"class","bg-primary/20 flex items-center justify-center"),o(x,"class","w-12 h-12 rounded-full ring-2 ring-secondary"),o(_,"class","avatar"),o(H,"class","text-lg font-medieval text-neutral font-bold truncate"),o(O,"class","flex gap-2 mt-1"),o(y,"class","flex-1 min-w-0"),o(h,"class","bg-gradient-to-r from-primary/10 to-accent/10 p-3 rounded-lg border border-primary/30 flex items-center gap-3"),o(a,"class","p-4 flex-shrink-0 bg-gradient-to-b from-[#f4e4c1] to-transparent"),o(K,"class","text-xs font-medieval text-neutral/60 text-center"),o(Z,"class","text-2xl font-bold text-neutral"),o(Q,"class","text-sm text-neutral/60"),o(z,"class","text-center"),o(he,"class",be="progress progress-"+n[8]+" w-full h-3"),he.value=$=n[1].currentHp,o(he,"max",me=n[1].maxHp),o(re,"class","text-xs text-center text-neutral/60"),o(j,"class","bg-neutral/10 justify-center items-center flex flex-col gap-1 px-2 rounded-lg border-2 border-primary/30"),o(M,"class","text-xs font-medieval text-neutral/60 text-center"),o(ne,"class",Ce="text-2xl font-bold text-"+(n[7]!==0?n[7]>0?"success":"error":"neutral")),o(J,"class","text-center"),o(ke,"class",Se="progress progress-"+(n[7]!==0?n[6]:n[8])+" w-full h-3"),ke.value=n[3],o(ke,"max",Le=n[1].maxHp),o(we,"class","text-xs text-center text-neutral/60"),o(B,"class",Pe="bg-"+(n[7]!==0?n[7]>0?"success":"error":"neutral")+"/10 p-4 rounded-lg gap-1 px-2 flex flex-col justify-center items-center border-2 border-"+(n[7]!==0?n[7]>0?"success":"error":"primary")+"/30"),o(Y,"class","grid grid-cols-2"),o(_e,"class","label"),o(Ae,"type","number"),o(Ae,"placeholder","Ej: 15"),o(Ae,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50 flex-1 text-center text-2xl font-bold"),o(Ae,"min","0"),o(Je,"class","text-xl"),o(Be,"class","font-medieval"),o(Ne,"class","btn btn-error flex-1"),Ne.disabled=lt=n[5]<=0,o(Ue,"class","text-xl"),o(ze,"class","font-medieval"),o(je,"class","btn btn-success flex-1"),je.disabled=$e=n[5]<=0,o(Ve,"class","flex gap-2"),o(G,"class","flex-1 p-4"),o(t,"class","card-parchment border-4 border-secondary mx-4 relative w-1/2 h-3/4 flex flex-col"),o(e,"class","modal modal-open z-50")},m(de,xe){te(de,e,xe),s(e,t),s(t,l),s(t,i),s(t,a),s(a,f),s(a,v),s(a,h),s(h,_),s(_,x),s(x,m),s(m,C),s(C,g),s(h,D),s(h,y),s(y,H),s(H,S),s(y,V),s(y,O),He&&He.m(O,null),s(t,N),s(t,G),s(G,Y),s(Y,j),s(j,K),s(j,P),s(j,z),s(z,Z),s(Z,le),s(z,W),s(z,Q),s(Q,fe),s(Q,ae),s(j,ue),s(j,he),s(j,Ee),s(j,re),s(re,w),s(re,X),s(Y,F),s(Y,B),s(B,M),s(B,ve),s(B,J),s(J,ne),s(ne,ge),s(J,Me),Fe.m(J,null),s(B,We),s(B,ke),s(B,Ze),s(B,we),s(we,Te),s(we,qe),s(G,De),s(G,oe),s(oe,_e),s(oe,et),s(oe,Ve),s(Ve,Ae),Ie(Ae,n[5]),s(Ve,ut),s(Ve,Ne),s(Ne,Je),s(Ne,dt),s(Ne,Be),s(Ve,nt),s(Ve,je),s(je,Ue),s(je,ft),s(je,ze),ht||(Zt=[ie(l,"click",n[11]),ie(Ae,"input",n[13]),ie(Ne,"click",n[9]),ie(je,"click",n[10])],ht=!0)},p(de,xe){xe&2&&E!==(E=de[1].isNpc?"üëπ":"üßô‚Äç‚ôÇÔ∏è")&&ce(g,E),xe&2&&L!==(L=de[1].name+"")&&ce(S,L),de[1].isNpc?He||(He=Pl(),He.c(),He.m(O,null)):He&&(He.d(1),He=null),xe&2&&ee!==(ee=de[1].currentHp+"")&&ce(le,ee),xe&2&&pe!==(pe=de[1].maxHp+"")&&ce(ae,pe),xe&256&&be!==(be="progress progress-"+de[8]+" w-full h-3")&&o(he,"class",be),xe&2&&$!==($=de[1].currentHp)&&(he.value=$),xe&2&&me!==(me=de[1].maxHp)&&o(he,"max",me),xe&16&&A!==(A=de[4].toFixed(0)+"")&&ce(w,A),xe&8&&ce(ge,de[3]),xe&128&&Ce!==(Ce="text-2xl font-bold text-"+(de[7]!==0?de[7]>0?"success":"error":"neutral"))&&o(ne,"class",Ce),Et===(Et=Yt(de))&&Fe?Fe.p(de,xe):(Fe.d(1),Fe=Et(de),Fe&&(Fe.c(),Fe.m(J,null))),xe&448&&Se!==(Se="progress progress-"+(de[7]!==0?de[6]:de[8])+" w-full h-3")&&o(ke,"class",Se),xe&8&&(ke.value=de[3]),xe&2&&Le!==(Le=de[1].maxHp)&&o(ke,"max",Le),xe&4&&Oe!==(Oe=de[2].toFixed(0)+"")&&ce(Te,Oe),xe&128&&Pe!==(Pe="bg-"+(de[7]!==0?de[7]>0?"success":"error":"neutral")+"/10 p-4 rounded-lg gap-1 px-2 flex flex-col justify-center items-center border-2 border-"+(de[7]!==0?de[7]>0?"success":"error":"primary")+"/30")&&o(B,"class",Pe),xe&32&&Xe(Ae.value)!==de[5]&&Ie(Ae,de[5]),xe&32&&lt!==(lt=de[5]<=0)&&(Ne.disabled=lt),xe&32&&$e!==($e=de[5]<=0)&&(je.disabled=$e)},d(de){de&&d(e),He&&He.d(),Fe.d(),ht=!1,rt(Zt)}}}function Pl(n){let e,t="NPC";return{c(){e=u("div"),e.textContent=t,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-31ycly"&&(e.textContent=t),this.h()},h(){o(e,"class","badge badge-xs badge-error")},m(l,r){te(l,e,r)},d(l){l&&d(e)}}}function ps(n){let e,t="Sin cambios";return{c(){e=u("p"),e.textContent=t,this.h()},l(l){e=c(l,"P",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-yn2w7t"&&(e.textContent=t),this.h()},h(){o(e,"class","text-sm text-neutral/60")},m(l,r){te(l,e,r)},p:ye,d(l){l&&d(e)}}}function bs(n){let e,t=n[7]>0?"+":"",l,r,i;return{c(){e=u("p"),l=q(t),r=q(n[7]),this.h()},l(a){e=c(a,"P",{class:!0});var f=b(e);l=R(f,t),r=R(f,n[7]),f.forEach(d),this.h()},h(){o(e,"class",i="text-lg font-bold text-"+(n[7]>0?"success":"error"))},m(a,f){te(a,e,f),s(e,l),s(e,r)},p(a,f){f&128&&t!==(t=a[7]>0?"+":"")&&ce(l,t),f&128&&ce(r,a[7]),f&128&&i!==(i="text-lg font-bold text-"+(a[7]>0?"success":"error"))&&o(e,"class",i)},d(a){a&&d(e)}}}function ms(n){let e,t=n[0]&&n[1]&&Ol(n);return{c(){t&&t.c(),e=bt()},l(l){t&&t.l(l),e=bt()},m(l,r){t&&t.m(l,r),te(l,e,r)},p(l,[r]){l[0]&&l[1]?t?t.p(l,r):(t=Ol(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ye,o:ye,d(l){l&&d(e),t&&t.d(l)}}}function _s(n,e,t){let l,r,i,a,f,p,{isOpen:v=!1}=e,{combatant:h=null}=e;const _=Bt();let x=0,m=0;function C(){if(h&&m>0){const y=-Math.abs(m);_("apply",y),t(5,m=0)}}function E(){if(h&&m>0){const y=Math.abs(m);_("apply",y),t(5,m=0)}}function g(){t(12,x=0),t(5,m=0),_("close")}function D(){m=Xe(this.value),t(5,m)}return n.$$set=y=>{"isOpen"in y&&t(0,v=y.isOpen),"combatant"in y&&t(1,h=y.combatant)},n.$$.update=()=>{n.$$.dirty&2&&t(4,l=h?h.currentHp/h.maxHp*100:0),n.$$.dirty&16&&t(8,r=l>50?"success":l>25?"warning":"error"),n.$$.dirty&4098&&t(3,i=h?Math.max(0,Math.min(h.maxHp,h.currentHp+x)):0),n.$$.dirty&10&&t(7,a=h?i-h.currentHp:0),n.$$.dirty&10&&t(2,f=h?i/h.maxHp*100:0),n.$$.dirty&4&&t(6,p=f>50?"success":f>25?"warning":"error")},[v,h,f,i,l,m,p,a,r,C,E,g,x,D]}class gs extends xt{constructor(e){super(),Ct(this,e,_s,ms,yt,{isOpen:0,combatant:1})}}function Al(n,e,t){const l=n.slice();l[15]=e[t];const r=Array.isArray(l[1].conditions)?l[1].conditions:[];l[16]=r;const i=l[16].includes(l[15].name);return l[17]=i,l}function Nl(n,e,t){const l=n.slice();return l[20]=e[t],l}function jl(n){let e,t,l,r="‚úï",i,a,f,p="‚ö†Ô∏è Estados de Combate",v,h,_,x,m,C,E=n[1].isNpc?"üëπ":"üßô‚Äç‚ôÇÔ∏è",g,D,y,H,L=n[1].name+"",S,V,O,N,G,Y=n[1].currentHp+"",j,K,T=n[1].maxHp+"",P,z,Z,ee,le=n[1].armorClass+"",W,Q,fe,pe,ae,ue,he,be="<span>‚ö†Ô∏è</span> <span>Estados Activos</span>",$,me,Ee=(n[1].conditions&&Array.isArray(n[1].conditions)?n[1].conditions.length:0)+"",re,A,w,X,F,B,M,se,ve,J,ne="üîç",ge,Ce,Me="Base de datos oficial de D&D 5e",We,ke,Se,Le,Ze;function we(oe,_e){return _e&2&&(w=null),w==null&&(w=!!(oe[1].conditions&&Array.isArray(oe[1].conditions)&&oe[1].conditions.length>0)),w?Cs:xs}let Oe=we(n,-1),Te=Oe(n);function qe(oe,_e){return _e&4&&(Se=null),oe[4]?Is:oe[3].length>0?ks:(Se==null&&(Se=!!oe[2].trim()),Se?Es:ys)}let Pe=qe(n,-1),De=Pe(n);return{c(){e=u("div"),t=u("div"),l=u("button"),l.textContent=r,i=I(),a=u("div"),f=u("h3"),f.textContent=p,v=I(),h=u("div"),_=u("div"),x=u("div"),m=u("div"),C=u("span"),g=q(E),D=I(),y=u("div"),H=u("h4"),S=q(L),V=I(),O=u("div"),N=u("div"),G=q("‚ù§Ô∏è "),j=q(Y),K=q("/"),P=q(T),z=I(),Z=u("div"),ee=q("üõ°Ô∏è "),W=q(le),Q=I(),fe=u("div"),pe=u("div"),ae=u("div"),ue=u("div"),he=u("h5"),he.innerHTML=be,$=I(),me=u("span"),re=q(Ee),A=I(),Te.c(),X=I(),F=u("div"),B=u("div"),M=u("div"),se=u("input"),ve=I(),J=u("div"),J.textContent=ne,ge=I(),Ce=u("p"),Ce.textContent=Me,We=I(),ke=u("div"),De.c(),this.h()},l(oe){e=c(oe,"DIV",{class:!0});var _e=b(e);t=c(_e,"DIV",{class:!0});var Ye=b(t);l=c(Ye,"BUTTON",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-1vc2djp"&&(l.textContent=r),i=k(Ye),a=c(Ye,"DIV",{class:!0});var et=b(a);f=c(et,"H3",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-j0oh10"&&(f.textContent=p),v=k(et),h=c(et,"DIV",{class:!0});var Ve=b(h);_=c(Ve,"DIV",{class:!0});var Ae=b(_);x=c(Ae,"DIV",{class:!0});var ut=b(x);m=c(ut,"DIV",{class:!0});var Ne=b(m);C=c(Ne,"SPAN",{class:!0});var Je=b(C);g=R(Je,E),Je.forEach(d),Ne.forEach(d),ut.forEach(d),Ae.forEach(d),D=k(Ve),y=c(Ve,"DIV",{class:!0});var ot=b(y);H=c(ot,"H4",{class:!0});var dt=b(H);S=R(dt,L),dt.forEach(d),V=k(ot),O=c(ot,"DIV",{class:!0});var Be=b(O);N=c(Be,"DIV",{class:!0});var tt=b(N);G=R(tt,"‚ù§Ô∏è "),j=R(tt,Y),K=R(tt,"/"),P=R(tt,T),tt.forEach(d),z=k(Be),Z=c(Be,"DIV",{class:!0});var lt=b(Z);ee=R(lt,"üõ°Ô∏è "),W=R(lt,le),lt.forEach(d),Be.forEach(d),ot.forEach(d),Ve.forEach(d),et.forEach(d),Q=k(Ye),fe=c(Ye,"DIV",{class:!0,style:!0});var nt=b(fe);pe=c(nt,"DIV",{class:!0,style:!0});var je=b(pe);ae=c(je,"DIV",{class:!0});var Ue=b(ae);ue=c(Ue,"DIV",{class:!0});var it=b(ue);he=c(it,"H5",{class:!0,"data-svelte-h":!0}),U(he)!=="svelte-12hilzf"&&(he.innerHTML=be),$=k(it),me=c(it,"SPAN",{class:!0});var ft=b(me);re=R(ft,Ee),ft.forEach(d),it.forEach(d),A=k(Ue),Te.l(Ue),Ue.forEach(d),je.forEach(d),X=k(nt),F=c(nt,"DIV",{class:!0,style:!0});var ze=b(F);B=c(ze,"DIV",{class:!0});var ct=b(B);M=c(ct,"DIV",{class:!0});var $e=b(M);se=c($e,"INPUT",{type:!0,placeholder:!0,class:!0}),ve=k($e),J=c($e,"DIV",{class:!0,"data-svelte-h":!0}),U(J)!=="svelte-1duc997"&&(J.textContent=ne),$e.forEach(d),ge=k(ct),Ce=c(ct,"P",{class:!0,"data-svelte-h":!0}),U(Ce)!=="svelte-hqlo3f"&&(Ce.textContent=Me),ct.forEach(d),We=k(ze),ke=c(ze,"DIV",{class:!0});var ht=b(ke);De.l(ht),ht.forEach(d),ze.forEach(d),nt.forEach(d),Ye.forEach(d),_e.forEach(d),this.h()},h(){o(l,"class","btn btn-sm btn-circle btn-ghost absolute right-3 top-3 z-10 hover:bg-error/20"),o(f,"class","font-bold text-2xl font-medieval text-neutral text-center mb-3"),o(C,"class","text-xl"),o(m,"class","bg-primary/20 flex items-center justify-center"),o(x,"class","w-12 h-12 rounded-full ring-2 ring-secondary"),o(_,"class","avatar"),o(H,"class","text-lg font-medieval text-neutral font-bold truncate"),o(N,"class","badge badge-xs bg-error/30 text-neutral border-error/50"),o(Z,"class","badge badge-xs bg-info/30 text-neutral border-info/50"),o(O,"class","flex gap-2 mt-1"),o(y,"class","flex-1 min-w-0"),o(h,"class","bg-gradient-to-r from-primary/10 to-accent/10 p-3 rounded-lg border border-primary/30 flex items-center gap-3"),o(a,"class","p-4 flex-shrink-0 bg-gradient-to-b from-[#f4e4c1] to-transparent"),o(he,"class","font-medieval text-neutral font-bold flex items-center gap-2"),o(me,"class","badge badge-warning badge-sm"),o(ue,"class","flex items-center justify-between mb-3"),o(ae,"class","bg-warning/10 rounded-lg border-2 border-warning/30 p-3 flex flex-col h-full"),o(pe,"class","md:w-1/3 flex flex-col"),qt(pe,"min-height","300px"),o(se,"type","text"),o(se,"placeholder","Buscar condici√≥n (ej: blinded, poisoned, stunned)..."),o(se,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50 w-full pr-10"),o(J,"class","absolute right-3 top-1/2 -translate-y-1/2 text-neutral/50"),o(M,"class","relative"),o(Ce,"class","text-xs text-neutral/50 mt-1 italic"),o(B,"class","mb-3"),o(ke,"class","flex-1 overflow-y-auto custom-scrollbar bg-neutral/5 rounded-lg border border-primary/20 p-3"),o(F,"class","md:w-2/3 flex flex-col"),qt(F,"min-height","300px"),o(fe,"class","flex-1 overflow-hidden flex flex-col md:flex-row gap-3 p-4"),qt(fe,"min-height","0"),o(t,"class","card-parchment border-4 border-secondary w-1/2 h-5/6 mx-4 relative flex flex-col"),o(e,"class","modal modal-open z-50")},m(oe,_e){te(oe,e,_e),s(e,t),s(t,l),s(t,i),s(t,a),s(a,f),s(a,v),s(a,h),s(h,_),s(_,x),s(x,m),s(m,C),s(C,g),s(h,D),s(h,y),s(y,H),s(H,S),s(y,V),s(y,O),s(O,N),s(N,G),s(N,j),s(N,K),s(N,P),s(O,z),s(O,Z),s(Z,ee),s(Z,W),s(t,Q),s(t,fe),s(fe,pe),s(pe,ae),s(ae,ue),s(ue,he),s(ue,$),s(ue,me),s(me,re),s(ae,A),Te.m(ae,null),s(fe,X),s(fe,F),s(F,B),s(B,M),s(M,se),Ie(se,n[2]),s(M,ve),s(M,J),s(B,ge),s(B,Ce),s(F,We),s(F,ke),De.m(ke,null),Le||(Ze=[ie(l,"click",n[8]),ie(se,"input",n[11]),ie(se,"input",n[5]),ie(e,"keydown",n[9])],Le=!0)},p(oe,_e){_e&2&&E!==(E=oe[1].isNpc?"üëπ":"üßô‚Äç‚ôÇÔ∏è")&&ce(g,E),_e&2&&L!==(L=oe[1].name+"")&&ce(S,L),_e&2&&Y!==(Y=oe[1].currentHp+"")&&ce(j,Y),_e&2&&T!==(T=oe[1].maxHp+"")&&ce(P,T),_e&2&&le!==(le=oe[1].armorClass+"")&&ce(W,le),_e&2&&Ee!==(Ee=(oe[1].conditions&&Array.isArray(oe[1].conditions)?oe[1].conditions.length:0)+"")&&ce(re,Ee),Oe===(Oe=we(oe,_e))&&Te?Te.p(oe,_e):(Te.d(1),Te=Oe(oe),Te&&(Te.c(),Te.m(ae,null))),_e&4&&se.value!==oe[2]&&Ie(se,oe[2]),Pe===(Pe=qe(oe,_e))&&De?De.p(oe,_e):(De.d(1),De=Pe(oe),De&&(De.c(),De.m(ke,null)))},d(oe){oe&&d(e),Te.d(),De.d(),Le=!1,rt(Ze)}}}function xs(n){let e,t='<div class="text-3xl mb-2 opacity-50">üòå</div> <p class="text-xs text-neutral/60 font-body italic">Sin estados activos</p>';return{c(){e=u("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-gjvbew"&&(e.innerHTML=t),this.h()},h(){o(e,"class","flex-1 flex flex-col items-center justify-center text-center py-6")},m(l,r){te(l,e,r)},p:ye,d(l){l&&d(e)}}}function Cs(n){let e,t=Re(n[1].conditions),l=[];for(let r=0;r<t.length;r+=1)l[r]=Ml(Nl(n,t,r));return{c(){e=u("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=c(r,"DIV",{class:!0});var i=b(e);for(let a=0;a<l.length;a+=1)l[a].l(i);i.forEach(d),this.h()},h(){o(e,"class","flex-1 overflow-y-auto custom-scrollbar pr-1 space-y-2")},m(r,i){te(r,e,i);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(r,i){if(i&130){t=Re(r[1].conditions);let a;for(a=0;a<t.length;a+=1){const f=Nl(r,t,a);l[a]?l[a].p(f,i):(l[a]=Ml(f),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(r){r&&d(e),mt(l,r)}}}function Ml(n){let e,t,l=n[20]+"",r,i,a,f="‚úï",p,v,h;function _(){return n[10](n[20])}return{c(){e=u("div"),t=u("span"),r=q(l),i=I(),a=u("button"),a.textContent=f,p=I(),this.h()},l(x){e=c(x,"DIV",{class:!0});var m=b(e);t=c(m,"SPAN",{class:!0});var C=b(t);r=R(C,l),C.forEach(d),i=k(m),a=c(m,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),U(a)!=="svelte-5t970f"&&(a.textContent=f),p=k(m),m.forEach(d),this.h()},h(){o(t,"class","font-medieval text-sm text-neutral flex-1"),o(a,"class","btn btn-xs btn-circle btn-ghost hover:bg-error hover:text-white"),o(a,"title","Eliminar"),o(e,"class","bg-warning/20 rounded px-3 py-2 border border-warning/40 flex items-center justify-between gap-2 hover:bg-warning/30 transition-colors")},m(x,m){te(x,e,m),s(e,t),s(t,r),s(e,i),s(e,a),s(e,p),v||(h=ie(a,"click",_),v=!0)},p(x,m){n=x,m&2&&l!==(l=n[20]+"")&&ce(r,l)},d(x){x&&d(e),v=!1,h()}}}function ys(n){let e,t='<div class="text-5xl mb-3">üìñ</div> <p class="text-neutral/70 font-body mb-2">Escribe para buscar condiciones</p> <div class="flex flex-wrap gap-1 justify-center text-xs text-neutral/50 mt-2"><span class="bg-neutral/10 px-2 py-1 rounded">blinded</span> <span class="bg-neutral/10 px-2 py-1 rounded">charmed</span> <span class="bg-neutral/10 px-2 py-1 rounded">frightened</span> <span class="bg-neutral/10 px-2 py-1 rounded">grappled</span> <span class="bg-neutral/10 px-2 py-1 rounded">paralyzed</span></div>';return{c(){e=u("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-981qn5"&&(e.innerHTML=t),this.h()},h(){o(e,"class","flex flex-col items-center justify-center h-full text-center px-4")},m(l,r){te(l,e,r)},p:ye,d(l){l&&d(e)}}}function Es(n){let e,t,l="üîç",r,i,a,f,p,v,h,_,x="‚ûï Agregar como personalizado",m,C;return{c(){e=u("div"),t=u("div"),t.textContent=l,r=I(),i=u("p"),a=q('No se encontr√≥ "'),f=u("span"),p=q(n[2]),v=q('"'),h=I(),_=u("button"),_.textContent=x,this.h()},l(E){e=c(E,"DIV",{class:!0});var g=b(e);t=c(g,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-sy51vw"&&(t.textContent=l),r=k(g),i=c(g,"P",{class:!0});var D=b(i);a=R(D,'No se encontr√≥ "'),f=c(D,"SPAN",{class:!0});var y=b(f);p=R(y,n[2]),y.forEach(d),v=R(D,'"'),D.forEach(d),h=k(g),_=c(g,"BUTTON",{class:!0,"data-svelte-h":!0}),U(_)!=="svelte-1rs0apo"&&(_.textContent=x),g.forEach(d),this.h()},h(){o(t,"class","text-4xl mb-3"),o(f,"class","font-bold"),o(i,"class","text-neutral/70 font-body mb-3"),o(_,"class","btn btn-primary btn-sm"),o(e,"class","flex flex-col items-center justify-center h-full text-center")},m(E,g){te(E,e,g),s(e,t),s(e,r),s(e,i),s(i,a),s(i,f),s(f,p),s(i,v),s(e,h),s(e,_),m||(C=ie(_,"click",n[13]),m=!0)},p(E,g){g&4&&ce(p,E[2])},d(E){E&&d(e),m=!1,C()}}}function ks(n){let e,t=Re(n[3]),l=[];for(let r=0;r<t.length;r+=1)l[r]=Sl(Al(n,t,r));return{c(){e=u("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=c(r,"DIV",{class:!0});var i=b(e);for(let a=0;a<l.length;a+=1)l[a].l(i);i.forEach(d),this.h()},h(){o(e,"class","space-y-2")},m(r,i){te(r,e,i);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(r,i){if(i&74){t=Re(r[3]);let a;for(a=0;a<t.length;a+=1){const f=Al(r,t,a);l[a]?l[a].p(f,i):(l[a]=Sl(f),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(r){r&&d(e),mt(l,r)}}}function Is(n){let e,t='<span class="loading loading-spinner loading-md text-secondary"></span> <p class="text-xs text-neutral/60 mt-2">Buscando...</p>';return{c(){e=u("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-io7n20"&&(e.innerHTML=t),this.h()},h(){o(e,"class","flex flex-col items-center justify-center h-full")},m(l,r){te(l,e,r)},p:ye,d(l){l&&d(e)}}}function Ll(n){let e,t="‚úì Activo";return{c(){e=u("span"),e.textContent=t,this.h()},l(l){e=c(l,"SPAN",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-mm16lr"&&(e.textContent=t),this.h()},h(){o(e,"class","badge badge-xs badge-success shrink-0")},m(l,r){te(l,e,r)},d(l){l&&d(e)}}}function Sl(n){let e,t,l,r=n[15].name+"",i,a,f,p,v=gt.cleanDescription(n[15].desc,120)+"",h,_,x,m,C,E,g=n[17]&&Ll();function D(){return n[12](n[15])}return{c(){e=u("button"),t=u("div"),l=u("span"),i=q(r),a=I(),g&&g.c(),f=I(),p=u("p"),h=q(v),_=I(),this.h()},l(y){e=c(y,"BUTTON",{class:!0});var H=b(e);t=c(H,"DIV",{class:!0});var L=b(t);l=c(L,"SPAN",{class:!0});var S=b(l);i=R(S,r),S.forEach(d),a=k(L),g&&g.l(L),L.forEach(d),f=k(H),p=c(H,"P",{class:!0});var V=b(p);h=R(V,v),V.forEach(d),_=k(H),H.forEach(d),this.h()},h(){o(l,"class","font-medieval font-bold text-neutral"),o(t,"class","flex items-start justify-between gap-2 mb-1"),o(p,"class","text-xs text-neutral/70 font-body leading-snug"),e.disabled=x=n[17],o(e,"class",m="w-full text-left p-3 rounded-lg border-2 transition-all "+(n[17]?"border-success/50 bg-success/10 cursor-not-allowed opacity-60":"border-primary/30 bg-[#f4e4c1]/50 hover:bg-[#f4e4c1] hover:border-primary/50 hover:shadow-md"))},m(y,H){te(y,e,H),s(e,t),s(t,l),s(l,i),s(t,a),g&&g.m(t,null),s(e,f),s(e,p),s(p,h),s(e,_),C||(E=ie(e,"click",D),C=!0)},p(y,H){n=y,H&8&&r!==(r=n[15].name+"")&&ce(i,r),n[17]?g||(g=Ll(),g.c(),g.m(t,null)):g&&(g.d(1),g=null),H&8&&v!==(v=gt.cleanDescription(n[15].desc,120)+"")&&ce(h,v),H&10&&x!==(x=n[17])&&(e.disabled=x),H&10&&m!==(m="w-full text-left p-3 rounded-lg border-2 transition-all "+(n[17]?"border-success/50 bg-success/10 cursor-not-allowed opacity-60":"border-primary/30 bg-[#f4e4c1]/50 hover:bg-[#f4e4c1] hover:border-primary/50 hover:shadow-md"))&&o(e,"class",m)},d(y){y&&d(e),g&&g.d(),C=!1,E()}}}function Ts(n){let e,t=n[0]&&n[1]&&jl(n);return{c(){t&&t.c(),e=bt()},l(l){t&&t.l(l),e=bt()},m(l,r){t&&t.m(l,r),te(l,e,r)},p(l,[r]){l[0]&&l[1]?t?t.p(l,r):(t=jl(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:ye,o:ye,d(l){l&&d(e),t&&t.d(l)}}}function Ds(n,e,t){let{isOpen:l=!1}=e,{combatant:r=null}=e;const i=Bt();let a="",f=[],p=!1;const v=Kl(async()=>{if(!a.trim()){t(3,f=[]);return}t(4,p=!0);try{const y=await gt.searchConditions(a);t(3,f=y.results)}catch(y){console.error("Error searching conditions:",y),t(3,f=[])}finally{t(4,p=!1)}},300);function h(y){if(!r||!y.trim())return;if((Array.isArray(r.conditions)?r.conditions:[]).includes(y)){console.log("Condici√≥n ya existe:",y);return}console.log("Agregando condici√≥n:",y),i("add",y),t(2,a=""),t(3,f=[])}function _(y){r&&(console.log("Removiendo condici√≥n:",y),i("remove",y))}function x(){t(2,a=""),t(3,f=[]),i("close")}function m(y){y.key==="Escape"&&x()}const C=y=>_(y);function E(){a=this.value,t(2,a)}const g=y=>h(y.name),D=()=>h(a.trim());return n.$$set=y=>{"isOpen"in y&&t(0,l=y.isOpen),"combatant"in y&&t(1,r=y.combatant)},[l,r,a,f,p,v,h,_,x,m,C,E,g,D]}class ws extends xt{constructor(e){super(),Ct(this,e,Ds,Ts,yt,{isOpen:0,combatant:1})}}function Bl(n,e,t){const l=n.slice();return l[45]=e[t],l[47]=t,l}function Ul(n){let e,t,l,r,i,a,f="‚úï",p,v;return{c(){e=u("div"),t=u("div"),l=u("span"),r=q(n[4]),i=I(),a=u("button"),a.textContent=f,this.h()},l(h){e=c(h,"DIV",{class:!0});var _=b(e);t=c(_,"DIV",{class:!0});var x=b(t);l=c(x,"SPAN",{});var m=b(l);r=R(m,n[4]),m.forEach(d),i=k(x),a=c(x,"BUTTON",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-4tcifc"&&(a.textContent=f),x.forEach(d),_.forEach(d),this.h()},h(){o(a,"class","btn btn-sm"),o(t,"class","alert alert-error"),o(e,"class","container mx-auto p-4")},m(h,_){te(h,e,_),s(e,t),s(t,l),s(l,r),s(t,i),s(t,a),p||(v=ie(a,"click",n[26]),p=!0)},p(h,_){_[0]&16&&ce(r,h[4])},d(h){h&&d(e),p=!1,v()}}}function Vs(n){let e,t,l,r,i,a,f=n[0].name+"",p,v,h,_,x,m=n[0].round+"",C,E,g,D,y=n[1].length+"",H,L,S,V,O="üîÑ LIVE",N,G,Y,j,K,T,P=n[12]&&zl(n),z=n[11]&&Rl(n);const Z=[As,Ps],ee=[];function le(W,Q){return W[1].length===0?0:1}return j=le(n),K=ee[j]=Z[j](n),{c(){e=u("div"),t=u("div"),l=u("div"),r=u("div"),i=u("div"),a=u("h2"),p=q(f),v=I(),h=u("div"),_=u("div"),x=q("üîÑ Ronda "),C=q(m),E=I(),g=u("div"),D=q("üë• "),H=q(y),L=q(" Combatientes"),S=I(),V=u("div"),V.textContent=O,N=I(),P&&P.c(),G=I(),z&&z.c(),Y=I(),K.c(),this.h()},l(W){e=c(W,"DIV",{class:!0});var Q=b(e);t=c(Q,"DIV",{class:!0});var fe=b(t);l=c(fe,"DIV",{class:!0});var pe=b(l);r=c(pe,"DIV",{class:!0});var ae=b(r);i=c(ae,"DIV",{});var ue=b(i);a=c(ue,"H2",{class:!0});var he=b(a);p=R(he,f),he.forEach(d),v=k(ue),h=c(ue,"DIV",{class:!0});var be=b(h);_=c(be,"DIV",{class:!0});var $=b(_);x=R($,"üîÑ Ronda "),C=R($,m),$.forEach(d),E=k(be),g=c(be,"DIV",{class:!0});var me=b(g);D=R(me,"üë• "),H=R(me,y),L=R(me," Combatientes"),me.forEach(d),S=k(be),V=c(be,"DIV",{class:!0,title:!0,"data-svelte-h":!0}),U(V)!=="svelte-14xbtsv"&&(V.textContent=O),be.forEach(d),ue.forEach(d),N=k(ae),P&&P.l(ae),ae.forEach(d),G=k(pe),z&&z.l(pe),pe.forEach(d),fe.forEach(d),Y=k(Q),K.l(Q),Q.forEach(d),this.h()},h(){o(a,"class","text-3xl font-medieval text-neutral mb-2"),o(_,"class","badge badge-ornate badge-lg"),o(g,"class","badge bg-info/30 border-info/50 text-neutral badge-lg"),o(V,"class","badge bg-success/30 border-success/50 text-neutral badge-lg"),o(V,"title","Sincronizaci√≥n en tiempo real activa"),o(h,"class","flex gap-4"),o(r,"class","flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4"),o(l,"class","card-body p-6"),o(t,"class","card-parchment mb-6 corner-ornament"),o(e,"class","p-4 max-w-4xl mx-auto")},m(W,Q){te(W,e,Q),s(e,t),s(t,l),s(l,r),s(r,i),s(i,a),s(a,p),s(i,v),s(i,h),s(h,_),s(_,x),s(_,C),s(h,E),s(h,g),s(g,D),s(g,H),s(g,L),s(h,S),s(h,V),s(r,N),P&&P.m(r,null),s(l,G),z&&z.m(l,null),s(e,Y),ee[j].m(e,null),T=!0},p(W,Q){(!T||Q[0]&1)&&f!==(f=W[0].name+"")&&ce(p,f),(!T||Q[0]&1)&&m!==(m=W[0].round+"")&&ce(C,m),(!T||Q[0]&2)&&y!==(y=W[1].length+"")&&ce(H,y),W[12]?P?P.p(W,Q):(P=zl(W),P.c(),P.m(r,null)):P&&(P.d(1),P=null),W[11]?z?z.p(W,Q):(z=Rl(W),z.c(),z.m(l,null)):z&&(z.d(1),z=null);let fe=j;j=le(W),j===fe?ee[j].p(W,Q):(Xt(),Ke(ee[fe],1,1,()=>{ee[fe]=null}),Kt(),K=ee[j],K?K.p(W,Q):(K=ee[j]=Z[j](W),K.c()),Ge(K,1),K.m(e,null))},i(W){T||(Ge(K),T=!0)},o(W){Ke(K),T=!1},d(W){W&&d(e),P&&P.d(),z&&z.d(),ee[j].d()}}}function Hs(n){let e,t,l,r="‚öîÔ∏è",i,a,f="No hay combate activo",p,v,h="El DM debe iniciar un encuentro para comenzar la batalla",_;function x(E,g){return E[12]?js:Ns}let m=x(n),C=m(n);return{c(){e=u("div"),t=u("div"),l=u("div"),l.textContent=r,i=I(),a=u("h2"),a.textContent=f,p=I(),v=u("p"),v.textContent=h,_=I(),C.c(),this.h()},l(E){e=c(E,"DIV",{class:!0});var g=b(e);t=c(g,"DIV",{class:!0});var D=b(t);l=c(D,"DIV",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-19xxu84"&&(l.textContent=r),i=k(D),a=c(D,"H2",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-itogws"&&(a.textContent=f),p=k(D),v=c(D,"P",{class:!0,"data-svelte-h":!0}),U(v)!=="svelte-1smrxik"&&(v.textContent=h),_=k(D),C.l(D),D.forEach(d),g.forEach(d),this.h()},h(){o(l,"class","text-6xl mb-4"),o(a,"class","text-3xl font-medieval text-neutral mb-4"),o(v,"class","text-neutral/70 font-body mb-6"),o(t,"class","card-parchment max-w-2xl w-full p-12 corner-ornament text-center"),o(e,"class","flex items-center justify-center h-full p-4")},m(E,g){te(E,e,g),s(e,t),s(t,l),s(t,i),s(t,a),s(t,p),s(t,v),s(t,_),C.m(t,null)},p(E,g){m===(m=x(E))&&C?C.p(E,g):(C.d(1),C=m(E),C&&(C.c(),C.m(t,null)))},i:ye,o:ye,d(E){E&&d(e),C.d()}}}function Os(n){let e,t='<span class="loading loading-spinner loading-lg text-secondary"></span>';return{c(){e=u("div"),e.innerHTML=t,this.h()},l(l){e=c(l,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-xh23f2"&&(e.innerHTML=t),this.h()},h(){o(e,"class","flex items-center justify-center h-full")},m(l,r){te(l,e,r)},p:ye,i:ye,o:ye,d(l){l&&d(e)}}}function zl(n){let e,t,l=`<span class="text-lg">‚ûï</span>
                      Agregar`,r,i,a,f="‚ñ∂Ô∏è",p,v,h,_,x="üèÅ Finalizar",m,C;return{c(){e=u("div"),t=u("button"),t.innerHTML=l,r=I(),i=u("button"),a=u("span"),a.textContent=f,p=q(`\r
                      Siguiente Turno`),h=I(),_=u("button"),_.textContent=x,this.h()},l(E){e=c(E,"DIV",{class:!0});var g=b(e);t=c(g,"BUTTON",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-txma1f"&&(t.innerHTML=l),r=k(g),i=c(g,"BUTTON",{class:!0});var D=b(i);a=c(D,"SPAN",{class:!0,"data-svelte-h":!0}),U(a)!=="svelte-vhmvlx"&&(a.textContent=f),p=R(D,`\r
                      Siguiente Turno`),D.forEach(d),h=k(g),_=c(g,"BUTTON",{class:!0,"data-svelte-h":!0}),U(_)!=="svelte-1ut7wc"&&(_.textContent=x),g.forEach(d),this.h()},h(){o(t,"class","btn btn-success btn-sm gap-2"),o(a,"class","text-lg"),o(i,"class","btn btn-dnd btn-sm gap-2"),i.disabled=v=n[1].length===0,o(_,"class","btn btn-error btn-sm"),o(e,"class","flex gap-2")},m(E,g){te(E,e,g),s(e,t),s(e,r),s(e,i),s(i,a),s(i,p),s(e,h),s(e,_),m||(C=[ie(t,"click",n[28]),ie(i,"click",n[22]),ie(_,"click",n[14])],m=!0)},p(E,g){g[0]&2&&v!==(v=E[1].length===0)&&(i.disabled=v)},d(E){E&&d(e),m=!1,rt(C)}}}function Rl(n){let e,t,l="TURNO ACTUAL",r,i,a=n[11].name+"",f;return{c(){e=u("div"),t=u("p"),t.textContent=l,r=I(),i=u("p"),f=q(a),this.h()},l(p){e=c(p,"DIV",{class:!0});var v=b(e);t=c(v,"P",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-j3qdhu"&&(t.textContent=l),r=k(v),i=c(v,"P",{class:!0});var h=b(i);f=R(h,a),h.forEach(d),v.forEach(d),this.h()},h(){o(t,"class","text-sm font-medieval text-neutral/70 mb-1"),o(i,"class","text-2xl font-bold font-medieval text-neutral"),o(e,"class","bg-gradient-to-r from-secondary/20 to-accent/20 p-4 rounded-lg border-2 border-secondary mt-4")},m(p,v){te(p,e,v),s(e,t),s(e,r),s(e,i),s(i,f)},p(p,v){v[0]&2048&&a!==(a=p[11].name+"")&&ce(f,a)},d(p){p&&d(e)}}}function Ps(n){let e,t,l=Re(n[1]),r=[];for(let a=0;a<l.length;a+=1)r[a]=ql(Bl(n,l,a));const i=a=>Ke(r[a],1,1,()=>{r[a]=null});return{c(){e=u("div");for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){e=c(a,"DIV",{class:!0});var f=b(e);for(let p=0;p<r.length;p+=1)r[p].l(f);f.forEach(d),this.h()},h(){o(e,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4")},m(a,f){te(a,e,f);for(let p=0;p<r.length;p+=1)r[p]&&r[p].m(e,null);t=!0},p(a,f){if(f[0]&462851){l=Re(a[1]);let p;for(p=0;p<l.length;p+=1){const v=Bl(a,l,p);r[p]?(r[p].p(v,f),Ge(r[p],1)):(r[p]=ql(v),r[p].c(),Ge(r[p],1),r[p].m(e,null))}for(Xt(),p=l.length;p<r.length;p+=1)i(p);Kt()}},i(a){if(!t){for(let f=0;f<l.length;f+=1)Ge(r[f]);t=!0}},o(a){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)Ke(r[f]);t=!1},d(a){a&&d(e),mt(r,a)}}}function As(n){let e,t,l="üé≤",r,i,a="Sin combatientes",f,p,v=n[12]?"Agrega personajes y criaturas para comenzar":"Esperando que el DM agregue combatientes",h;return{c(){e=u("div"),t=u("div"),t.textContent=l,r=I(),i=u("p"),i.textContent=a,f=I(),p=u("p"),h=q(v),this.h()},l(_){e=c(_,"DIV",{class:!0});var x=b(e);t=c(x,"DIV",{class:!0,"data-svelte-h":!0}),U(t)!=="svelte-9xsxws"&&(t.textContent=l),r=k(x),i=c(x,"P",{class:!0,"data-svelte-h":!0}),U(i)!=="svelte-180lhql"&&(i.textContent=a),f=k(x),p=c(x,"P",{class:!0});var m=b(p);h=R(m,v),m.forEach(d),x.forEach(d),this.h()},h(){o(t,"class","text-4xl mb-3"),o(i,"class","text-xl font-medieval text-neutral mb-2"),o(p,"class","text-neutral/70 font-body"),o(e,"class","card-parchment p-12 text-center")},m(_,x){te(_,e,x),s(e,t),s(e,r),s(e,i),s(e,f),s(e,p),s(p,h)},p(_,x){x[0]&4096&&v!==(v=_[12]?"Agrega personajes y criaturas para comenzar":"Esperando que el DM agregue combatientes")&&ce(h,v)},i:ye,o:ye,d(_){_&&d(e)}}}function ql(n){let e,t;return e=new cn({props:{combatant:n[45],isCurrentTurn:n[47]===n[0].turnIndex%n[1].length,isDM:!!n[12]}}),e.$on("updateHP",n[17]),e.$on("addCondition",n[18]),e.$on("remove",n[16]),{c(){St(e.$$.fragment)},l(l){Lt(e.$$.fragment,l)},m(l,r){Mt(e,l,r),t=!0},p(l,r){const i={};r[0]&2&&(i.combatant=l[45]),r[0]&3&&(i.isCurrentTurn=l[47]===l[0].turnIndex%l[1].length),r[0]&4096&&(i.isDM=!!l[12]),e.$set(i)},i(l){t||(Ge(e.$$.fragment,l),t=!0)},o(l){Ke(e.$$.fragment,l),t=!1},d(l){jt(e,l)}}}function Ns(n){let e,t="Esperando que el DM inicie el combate...";return{c(){e=u("p"),e.textContent=t,this.h()},l(l){e=c(l,"P",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-2v0fgb"&&(e.textContent=t),this.h()},h(){o(e,"class","text-sm text-neutral/50 italic")},m(l,r){te(l,e,r)},p:ye,d(l){l&&d(e)}}}function js(n){let e,t=`<span class="text-2xl">‚öîÔ∏è</span>
                Iniciar Encuentro`,l,r;return{c(){e=u("button"),e.innerHTML=t,this.h()},l(i){e=c(i,"BUTTON",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-78s565"&&(e.innerHTML=t),this.h()},h(){o(e,"class","btn btn-dnd btn-lg")},m(i,a){te(i,e,a),l||(r=ie(e,"click",n[27]),l=!0)},p:ye,d(i){i&&d(e),l=!1,r()}}}function Fl(n){let e,t,l,r="‚öîÔ∏è Iniciar Encuentro",i,a,f,p='<span class="label-text font-medieval text-neutral text-lg">Nombre del Encuentro</span>',v,h,_,x,m,C="Cancelar",E,g,D,y="‚öîÔ∏è",H,L,S,V;return{c(){e=u("div"),t=u("div"),l=u("h3"),l.textContent=r,i=I(),a=u("div"),f=u("label"),f.innerHTML=p,v=I(),h=u("input"),_=I(),x=u("div"),m=u("button"),m.textContent=C,E=I(),g=u("button"),D=u("span"),D.textContent=y,H=q(`\r
          Iniciar Combate`),this.h()},l(O){e=c(O,"DIV",{class:!0});var N=b(e);t=c(N,"DIV",{class:!0});var G=b(t);l=c(G,"H3",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-jkbohq"&&(l.textContent=r),i=k(G),a=c(G,"DIV",{class:!0});var Y=b(a);f=c(Y,"LABEL",{class:!0,"data-svelte-h":!0}),U(f)!=="svelte-13njkxf"&&(f.innerHTML=p),v=k(Y),h=c(Y,"INPUT",{type:!0,placeholder:!0,class:!0}),Y.forEach(d),_=k(G),x=c(G,"DIV",{class:!0});var j=b(x);m=c(j,"BUTTON",{class:!0,"data-svelte-h":!0}),U(m)!=="svelte-173ap95"&&(m.textContent=C),E=k(j),g=c(j,"BUTTON",{class:!0});var K=b(g);D=c(K,"SPAN",{class:!0,"data-svelte-h":!0}),U(D)!=="svelte-v5ojki"&&(D.textContent=y),H=R(K,`\r
          Iniciar Combate`),K.forEach(d),j.forEach(d),G.forEach(d),N.forEach(d),this.h()},h(){o(l,"class","font-bold text-2xl font-medieval text-neutral mb-4 text-center"),o(f,"class","label"),o(h,"type","text"),o(h,"placeholder","Ej: Emboscada de Orcos"),o(h,"class","input input-bordered bg-[#2d241c] text-base-content border-primary/50 text-lg"),o(a,"class","form-control"),o(m,"class","btn btn-outline border-2 border-neutral text-neutral hover:bg-neutral hover:text-secondary font-medieval"),o(D,"class","text-xl"),o(g,"class","btn btn-dnd"),g.disabled=L=!n[7].trim(),o(x,"class","modal-action justify-center gap-4"),o(t,"class","modal-box card-parchment border-4 border-secondary"),o(e,"class","modal modal-open z-50")},m(O,N){te(O,e,N),s(e,t),s(t,l),s(t,i),s(t,a),s(a,f),s(a,v),s(a,h),Ie(h,n[7]),s(t,_),s(t,x),s(x,m),s(x,E),s(x,g),s(g,D),s(g,H),S||(V=[ie(h,"input",n[29]),ie(m,"click",n[30]),ie(g,"click",n[13])],S=!0)},p(O,N){N[0]&128&&h.value!==O[7]&&Ie(h,O[7]),N[0]&128&&L!==(L=!O[7].trim())&&(g.disabled=L)},d(O){O&&d(e),S=!1,rt(V)}}}function Ms(n){let e,t,l,r,i,a,f,p,v,h,_,x,m,C,E,g,D,y=n[4]&&Ul(n);const H=[Os,Hs,Vs],L=[];function S(T,P){return T[3]?0:T[0]?2:1}i=S(n),a=L[i]=H[i](n);let V=n[6]&&Fl(n);function O(T){n[31](T)}let N={combatant:n[10]};n[8]!==void 0&&(N.isOpen=n[8]),v=new gs({props:N}),Ft.push(()=>Gt(v,"isOpen",O)),v.$on("apply",n[19]),v.$on("close",n[32]);function G(T){n[33](T)}let Y={combatant:n[10]};n[9]!==void 0&&(Y.isOpen=n[9]),x=new ws({props:Y}),Ft.push(()=>Gt(x,"isOpen",G)),x.$on("add",n[20]),x.$on("remove",n[21]),x.$on("close",n[34]);function j(T){n[35](T)}let K={players:n[2]};return n[5]!==void 0&&(K.isOpen=n[5]),E=new vs({props:K}),Ft.push(()=>Gt(E,"isOpen",j)),E.$on("add",n[15]),E.$on("close",n[36]),{c(){e=u("div"),y&&y.c(),t=I(),l=u("div"),r=u("div"),a.c(),f=I(),V&&V.c(),p=I(),St(v.$$.fragment),_=I(),St(x.$$.fragment),C=I(),St(E.$$.fragment),this.h()},l(T){e=c(T,"DIV",{class:!0});var P=b(e);y&&y.l(P),t=k(P),l=c(P,"DIV",{class:!0});var z=b(l);r=c(z,"DIV",{class:!0});var Z=b(r);a.l(Z),Z.forEach(d),z.forEach(d),P.forEach(d),f=k(T),V&&V.l(T),p=k(T),Lt(v.$$.fragment,T),_=k(T),Lt(x.$$.fragment,T),C=k(T),Lt(E.$$.fragment,T),this.h()},h(){o(r,"class","flex-1"),o(l,"class","flex flex-1"),o(e,"class","min-h-screen flex flex-col")},m(T,P){te(T,e,P),y&&y.m(e,null),s(e,t),s(e,l),s(l,r),L[i].m(r,null),te(T,f,P),V&&V.m(T,P),te(T,p,P),Mt(v,T,P),te(T,_,P),Mt(x,T,P),te(T,C,P),Mt(E,T,P),D=!0},p(T,P){T[4]?y?y.p(T,P):(y=Ul(T),y.c(),y.m(e,t)):y&&(y.d(1),y=null);let z=i;i=S(T),i===z?L[i].p(T,P):(Xt(),Ke(L[z],1,1,()=>{L[z]=null}),Kt(),a=L[i],a?a.p(T,P):(a=L[i]=H[i](T),a.c()),Ge(a,1),a.m(r,null)),T[6]?V?V.p(T,P):(V=Fl(T),V.c(),V.m(p.parentNode,p)):V&&(V.d(1),V=null);const Z={};P[0]&1024&&(Z.combatant=T[10]),!h&&P[0]&256&&(h=!0,Z.isOpen=T[8],Wt(()=>h=!1)),v.$set(Z);const ee={};P[0]&1024&&(ee.combatant=T[10]),!m&&P[0]&512&&(m=!0,ee.isOpen=T[9],Wt(()=>m=!1)),x.$set(ee);const le={};P[0]&4&&(le.players=T[2]),!g&&P[0]&32&&(g=!0,le.isOpen=T[5],Wt(()=>g=!1)),E.$set(le)},i(T){D||(Ge(a),Ge(v.$$.fragment,T),Ge(x.$$.fragment,T),Ge(E.$$.fragment,T),D=!0)},o(T){Ke(a),Ke(v.$$.fragment,T),Ke(x.$$.fragment,T),Ke(E.$$.fragment,T),D=!1},d(T){T&&(d(e),d(f),d(p),d(_),d(C)),y&&y.d(),L[i].d(),V&&V.d(T),jt(v,T),jt(x,T),jt(E,T)}}}function Ls(n,e,t){let l,r,i,a,f;il(n,ln,w=>t(24,a=w)),il(n,tn,w=>t(25,f=w)),en.set("Combate");let p=null,v=null,h=[],_=[],x=!0,m="",C=!1,E=!1,g="",D=!1,y=!1,H=null,L=null,S=null;const V=nn(an);Yl(async()=>{await G(),await Y(),await O()}),$l(()=>{L&&L(),S&&S()});async function O(){try{t(3,x=!0);const w=cl(V,"encounters"),X=ul(w,Jt("campaignId","==",l),Jt("isActive","==",!0));L=dl(X,F=>{if(F.empty)t(0,v=null),t(1,h=[]),S&&(S(),S=null);else{const B=F.docs[0];t(0,v={id:B.id,...B.data()}),!S&&v&&N(v.id)}t(3,x=!1)},F=>{console.error("Error en listener de encuentro:",F),t(4,m=F.message),t(3,x=!1)})}catch(w){t(4,m=w.message),t(3,x=!1)}}function N(w){const X=cl(V,"combatants"),F=ul(X,Jt("encounterId","==",w),sn("initiative","desc"));S=dl(F,B=>{if(t(1,h=B.docs.map(M=>({id:M.id,...M.data()}))),H){const M=h.find(se=>se.id===H.id);M&&t(10,H=M)}},B=>{console.error("Error en listener de combatientes:",B)})}async function G(){try{t(23,p=await Qe.getCampaign(l))}catch(w){t(4,m=w.message)}}async function Y(){try{t(2,_=await Qe.getCampaignCharacters(l))}catch(w){console.error("Error loading characters:",w)}}async function j(){if(g.trim())try{await Qe.createEncounter(l,g),t(6,E=!1),t(7,g="")}catch(w){t(4,m=w.message)}}async function K(){if(!(!v||!confirm("¬øFinalizar este encuentro? Los HP actuales se guardar√°n en los personajes.")))try{await Qe.endEncounter(v.id)}catch(w){t(4,m=w.message)}}async function T(w){if(v)try{await Qe.addCombatant(v.id,w.detail),t(5,C=!1)}catch(X){t(4,m=X.message)}}async function P(w){const X=w.detail;if(confirm(`¬øEliminar a ${X.name} del combate?`))try{await Qe.removeCombatant(X.id)}catch(F){t(4,m=F.message)}}function z(w){t(10,H=w.detail),t(8,D=!0),t(9,y=!1)}function Z(w){t(10,H=w.detail),t(9,y=!0),t(8,D=!1)}async function ee(w){if(H)try{const X=w.detail,F=Math.max(0,Math.min(H.maxHp,H.currentHp+X));await Qe.updateCombatant(H.id,{currentHp:F}),t(8,D=!1),t(10,H=null)}catch(X){t(4,m=X.message)}}async function le(w){if(H)try{const X=w.detail,F=Array.isArray(H.conditions)?H.conditions:[];if(F.includes(X)){console.log("Condici√≥n ya existe, ignorando");return}const B=[...F,X];await Qe.updateCombatant(H.id,{conditions:B})}catch(X){t(4,m=X.message)}}async function W(w){if(H)try{const X=w.detail,B=(Array.isArray(H.conditions)?H.conditions:[]).filter(M=>M!==X);await Qe.updateCombatant(H.id,{conditions:B})}catch(X){t(4,m=X.message)}}async function Q(){if(v)try{await Qe.nextTurn(v.id)}catch(w){t(4,m=w.message)}}const fe=()=>t(4,m=""),pe=()=>t(6,E=!0),ae=()=>t(5,C=!0);function ue(){g=this.value,t(7,g)}const he=()=>{t(6,E=!1),t(7,g="")};function be(w){D=w,t(8,D)}const $=()=>{t(8,D=!1),t(10,H=null)};function me(w){y=w,t(9,y)}const Ee=()=>{t(9,y=!1),t(10,H=null)};function re(w){C=w,t(5,C)}const A=()=>t(5,C=!1);return n.$$.update=()=>{n.$$.dirty[0]&33554432&&(l=f.params.id||""),n.$$.dirty[0]&25165824&&t(12,r=p&&a&&p.dmId===a.uid),n.$$.dirty[0]&3&&t(11,i=v&&h.length>0?h[v.turnIndex%h.length]:null)},[v,h,_,x,m,C,E,g,D,y,H,i,r,j,K,T,P,z,Z,ee,le,W,Q,p,a,f,fe,pe,ae,ue,he,be,$,me,Ee,re,A]}class Gs extends xt{constructor(e){super(),Ct(this,e,Ls,Ms,yt,{},null,[-1,-1])}}export{Gs as component};
